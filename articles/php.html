<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PHP 基础教程 - 我的个人博客</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/markdown.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>我的个人博客</h1>
            <nav>
                <span><a href="../index.html" class="no-underline">首页</a></span>
            </nav>
        </header>

        <main>
            <div class="messages-list">
                <div class="messages-header">
                    <h3>PHP 基础教程</h3>
                    <a href="../index.html" class="btn">返回首页</a>
                </div>

                <div class="message-item">
                    <div class="message-header">
                        <span class="username">技术分享</span>
                        <span class="time">2025-12-20</span>
                    </div>
                    <div class="message-content">
                        <div class="markdown-content">
                            <h2>基本语法</h2>
                            <h3>PHP 标记</h3>
                            <pre><code class="language-php">&lt;?php
    // PHP 代码
?&gt;</code></pre>
                            <h3>变量定义</h3>
                            <pre><code class="language-php">&lt;?php
$name = &quot;张三&quot;;        // 字符串
$age = 25;            // 整数
$price = 99.99;       // 浮点数
$is_active = true;    // 布尔值
?&gt;</code></pre>
                            <h3>函数定义</h3>
                            <pre><code class="language-php">&lt;?php
function greet($name) {
    return &quot;Hello, &quot; . $name . &quot;!&quot;;
}

function calculateSum($a, $b) {
    return $a + $b;
}

// 调用函数
echo greet(&quot;张三&quot;);
echo calculateSum(10, 20);
?&gt;</code></pre>
                            <h2>数据类型</h2>
                            <h3>基本类型</h3>
                            <pre><code class="language-php">&lt;?php
// 字符串
$text = &quot;Hello World&quot;;

// 整数
$number = 42;

// 浮点数
$decimal = 3.14;

// 布尔值
$flag = true;

// 数组
$fruits = array(&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;);
$person = array(
    &quot;name&quot; =&gt; &quot;李四&quot;,
    &quot;age&quot; =&gt; 30,
    &quot;city&quot; =&gt; &quot;北京&quot;
);

// 对象
class User {
    public $name;
    public $age;
}
$user = new User();
$user-&gt;name = &quot;王五&quot;;
$user-&gt;age = 25;
?&gt;</code></pre>
                            <h2>常用函数</h2>
                            <h3>字符串函数</h3>
                            <pre><code class="language-php">&lt;?php
$text = &quot;Hello World&quot;;

// 字符串长度
echo strlen($text);                    // 11

// 查找字符串位置
echo strpos($text, &quot;World&quot;);            // 6

// 字符串替换
echo str_replace(&quot;World&quot;, &quot;PHP&quot;, $text); // Hello PHP

// 大小写转换
echo strtoupper($text);                 // HELLO WORLD
echo strtolower($text);                 // hello world

// 去除空格
echo trim(&quot;  hello  &quot;);                 // hello

// 字符串分割
$parts = explode(&quot; &quot;, $text);           // [&quot;Hello&quot;, &quot;World&quot;]

// 字符串连接
echo $text . &quot; - &quot; . &quot;PHP&quot;;             // Hello World - PHP
?&gt;</code></pre>
                            <h3>数组函数</h3>
                            <pre><code class="language-php">&lt;?php
$fruits = [&quot;apple&quot;, &quot;banana&quot;, &quot;orange&quot;];

// 数组长度
echo count($fruits);                    // 3

// 添加元素
array_push($fruits, &quot;grape&quot;);

// 删除元素
array_pop($fruits);

// 查找元素
if (in_array(&quot;apple&quot;, $fruits)) {
    echo &quot;Found apple!&quot;;
}

// 数组排序
sort($fruits);
rsort($fruits);

// 数组合并
$more_fruits = [&quot;grape&quot;, &quot;mango&quot;];
$all_fruits = array_merge($fruits, $more_fruits);
?&gt;</code></pre>
                            <h3>数学函数</h3>
                            <pre><code class="language-php">&lt;?php
// 基本数学运算
echo pi();                              // 3.1415926535898
echo min(1, 3, 5, 7);                   // 1
echo max(1, 3, 5, 7);                   // 7
echo abs(-5);                           // 5
echo sqrt(16);                          // 4
echo round(3.6);                        // 4
echo rand(1, 100);                      // 随机数 1-100
?&gt;</code></pre>
                            <h2>条件语句</h2>
                            <h3>if-else 语句</h3>
                            <pre><code class="language-php">&lt;?php
$score = 85;

if ($score &gt;= 90) {
    echo &quot;优秀&quot;;
} elseif ($score &gt;= 80) {
    echo &quot;良好&quot;;
} elseif ($score &gt;= 60) {
    echo &quot;及格&quot;;
} else {
    echo &quot;不及格&quot;;
}
?&gt;</code></pre>
                            <h3>switch 语句</h3>
                            <pre><code class="language-php">&lt;?php
$day = &quot;Monday&quot;;

switch ($day) {
    case &quot;Monday&quot;:
        echo &quot;星期一&quot;;
        break;
    case &quot;Tuesday&quot;:
        echo &quot;星期二&quot;;
        break;
    default:
        echo &quot;其他&quot;;
}
?&gt;</code></pre>
                            <h2>循环语句</h2>
                            <h3>for 循环</h3>
                            <pre><code class="language-php">&lt;?php
for ($i = 1; $i &lt;= 10; $i++) {
    echo $i . &quot; &quot;;
}
?&gt;</code></pre>
                            <h3>while 循环</h3>
                            <pre><code class="language-php">&lt;?php
$count = 1;
while ($count &lt;= 5) {
    echo &quot;Count: &quot; . $count . &quot;&lt;br&gt;&quot;;
    $count++;
}
?&gt;</code></pre>
                            <h3>foreach 循环</h3>
                            <pre><code class="language-php">&lt;?php
$colors = [&quot;red&quot;, &quot;green&quot;, &quot;blue&quot;];
foreach ($colors as $color) {
    echo $color . &quot;&lt;br&gt;&quot;;
}

// 关联数组
$person = [
    &quot;name&quot; =&gt; &quot;张三&quot;,
    &quot;age&quot; =&gt; 25,
    &quot;city&quot; =&gt; &quot;北京&quot;
];
foreach ($person as $key =&gt; $value) {
    echo $key . &quot;: &quot; . $value . &quot;&lt;br&gt;&quot;;
}
?&gt;</code></pre>
                            <h2>函数进阶</h2>
                            <h3>参数默认值</h3>
                            <pre><code class="language-php">&lt;?php
function greet($name, $greeting = &quot;Hello&quot;) {
    return $greeting . &quot;, &quot; . $name . &quot;!&quot;;
}

echo greet(&quot;张三&quot;);           // Hello, 张三!
echo greet(&quot;李四&quot;, &quot;Hi&quot;);     // Hi, 李四!
?&gt;</code></pre>
                            <h3>可变参数</h3>
                            <pre><code class="language-php">&lt;?php
function sum(...$numbers) {
    $total = 0;
    foreach ($numbers as $number) {
        $total += $number;
    }
    return $total;
}

echo sum(1, 2, 3, 4, 5);     // 15
?&gt;</code></pre>
                            <h3>返回多个值</h3>
                            <pre><code class="language-php">&lt;?php
function getUserInfo($id) {
    // 模拟数据库查询
    $users = [
        1 =&gt; [&quot;name&quot; =&gt; &quot;张三&quot;, &quot;age&quot; =&gt; 25],
        2 =&gt; [&quot;name&quot; =&gt; &quot;李四&quot;, &quot;age&quot; =&gt; 30]
    ];
    
    return $users[$id] ?? null;
}

$user = getUserInfo(1);
if ($user) {
    echo &quot;姓名: &quot; . $user['name'] . &quot;, 年龄: &quot; . $user['age'];
}
?&gt;</code></pre>
                            <h2>前后端交互</h2>
                            <h3>表单处理</h3>
                            <pre><code class="language-php">&lt;?php
// process_form.php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $name = $_POST['name'] ?? '';
    $email = $_POST['email'] ?? '';
    $age = $_POST['age'] ?? '';
    
    // 数据验证
    if (empty($name) || empty($email)) {
        echo &quot;姓名和邮箱不能为空！&quot;;
    } elseif (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
        echo &quot;邮箱格式不正确！&quot;;
    } else {
        echo &quot;提交成功！&lt;br&gt;&quot;;
        echo &quot;姓名: &quot; . htmlspecialchars($name) . &quot;&lt;br&gt;&quot;;
        echo &quot;邮箱: &quot; . htmlspecialchars($email) . &quot;&lt;br&gt;&quot;;
        echo &quot;年龄: &quot; . htmlspecialchars($age) . &quot;&lt;br&gt;&quot;;
    }
}
?&gt;</code></pre>
                            <h3>HTML 表单</h3>
                            <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;用户注册&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form method=&quot;POST&quot; action=&quot;process_form.php&quot;&gt;
        &lt;label&gt;姓名:&lt;/label&gt;
        &lt;input type=&quot;text&quot; name=&quot;name&quot; required&gt;&lt;br&gt;&lt;br&gt;
        
        &lt;label&gt;邮箱:&lt;/label&gt;
        &lt;input type=&quot;email&quot; name=&quot;email&quot; required&gt;&lt;br&gt;&lt;br&gt;
        
        &lt;label&gt;年龄:&lt;/label&gt;
        &lt;input type=&quot;number&quot; name=&quot;age&quot;&gt;&lt;br&gt;&lt;br&gt;
        
        &lt;input type=&quot;submit&quot; value=&quot;提交&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                            <h3>AJAX 交互</h3>
                            <pre><code class="language-php">&lt;?php
// api.php
header('Content-Type: application/json');

if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;GET&quot;) {
    $action = $_GET['action'] ?? '';
    
    switch ($action) {
        case 'get_users':
            $users = [
                [&quot;id&quot; =&gt; 1, &quot;name&quot; =&gt; &quot;张三&quot;, &quot;email&quot; =&gt; &quot;zhangsan@example.com&quot;],
                [&quot;id&quot; =&gt; 2, &quot;name&quot; =&gt; &quot;李四&quot;, &quot;email&quot; =&gt; &quot;lisi@example.com&quot;],
                [&quot;id&quot; =&gt; 3, &quot;name&quot; =&gt; &quot;王五&quot;, &quot;email&quot; =&gt; &quot;wangwu@example.com&quot;]
            ];
            echo json_encode([&quot;success&quot; =&gt; true, &quot;data&quot; =&gt; $users]);
            break;
            
        case 'get_user':
            $id = $_GET['id'] ?? 0;
            $users = [
                1 =&gt; [&quot;id&quot; =&gt; 1, &quot;name&quot; =&gt; &quot;张三&quot;, &quot;email&quot; =&gt; &quot;zhangsan@example.com&quot;],
                2 =&gt; [&quot;id&quot; =&gt; 2, &quot;name&quot; =&gt; &quot;李四&quot;, &quot;email&quot; =&gt; &quot;lisi@example.com&quot;]
            ];
            if (isset($users[$id])) {
                echo json_encode([&quot;success&quot; =&gt; true, &quot;data&quot; =&gt; $users[$id]]);
            } else {
                echo json_encode([&quot;success&quot; =&gt; false, &quot;message&quot; =&gt; &quot;用户不存在&quot;]);
            }
            break;
            
        default:
            echo json_encode([&quot;success&quot; =&gt; false, &quot;message&quot; =&gt; &quot;未知操作&quot;]);
    }
} elseif ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot;) {
    $data = json_decode(file_get_contents('php://input'), true);
    
    if ($data['action'] == 'add_user') {
        // 处理添加用户逻辑
        echo json_encode([&quot;success&quot; =&gt; true, &quot;message&quot; =&gt; &quot;用户添加成功&quot;]);
    }
}
?&gt;</code></pre>
                            <h3>JavaScript AJAX 调用</h3>
                            <pre><code class="language-javascript">// 获取用户列表
fetch('api.php?action=get_users')
    .then(response =&gt; response.json())
    .then(data =&gt; {
        if (data.success) {
            console.log('用户列表:', data.data);
            // 渲染用户列表到页面
        }
    })
    .catch(error =&gt; console.error('错误:', error));

// 获取单个用户
fetch('api.php?action=get_user&amp;id=1')
    .then(response =&gt; response.json())
    .then(data =&gt; {
        if (data.success) {
            console.log('用户信息:', data.data);
        }
    });

// 添加用户
fetch('api.php', {
    method: 'POST',
    headers: {
        'Content-Type': 'application/json',
    },
    body: JSON.stringify({
        action: 'add_user',
        name: '新用户',
        email: 'newuser@example.com'
    })
})
.then(response =&gt; response.json())
.then(data =&gt; {
    if (data.success) {
        console.log('添加成功');
    }
});</code></pre>
                            <h3>文件上传</h3>
                            <pre><code class="language-php">&lt;?php
// upload.php
if ($_SERVER[&quot;REQUEST_METHOD&quot;] == &quot;POST&quot; &amp;&amp; isset($_FILES[&quot;file&quot;])) {
    $file = $_FILES[&quot;file&quot;];
    $upload_dir = &quot;uploads/&quot;;
    
    // 创建上传目录
    if (!file_exists($upload_dir)) {
        mkdir($upload_dir, 0777, true);
    }
    
    // 文件验证
    $allowed_types = [&quot;jpg&quot;, &quot;jpeg&quot;, &quot;png&quot;, &quot;gif&quot;];
    $file_extension = strtolower(pathinfo($file[&quot;name&quot;], PATHINFO_EXTENSION));
    
    if (in_array($file_extension, $allowed_types)) {
        if ($file[&quot;size&quot;] &lt; 5000000) { // 5MB限制
            $new_filename = time() . &quot;_&quot; . basename($file[&quot;name&quot;]);
            $target_file = $upload_dir . $new_filename;
            
            if (move_uploaded_file($file[&quot;tmp_name&quot;], $target_file)) {
                echo &quot;文件上传成功: &quot; . $new_filename;
            } else {
                echo &quot;文件上传失败&quot;;
            }
        } else {
            echo &quot;文件太大，请上传小于5MB的文件&quot;;
        }
    } else {
        echo &quot;只允许上传图片文件&quot;;
    }
}
?&gt;</code></pre>
                            <h3>文件上传表单</h3>
                            <pre><code class="language-html">&lt;!DOCTYPE html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;title&gt;文件上传&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;form method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot; action=&quot;upload.php&quot;&gt;
        &lt;label&gt;选择文件:&lt;/label&gt;
        &lt;input type=&quot;file&quot; name=&quot;file&quot; accept=&quot;image/*&quot; required&gt;&lt;br&gt;&lt;br&gt;
        &lt;input type=&quot;submit&quot; value=&quot;上传&quot;&gt;
    &lt;/form&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
                            <h2>数据库交互</h2>
                            <h3>MySQL 连接和查询</h3>
                            <pre><code class="language-php">&lt;?php
// 数据库配置
$host = &quot;localhost&quot;;
$username = &quot;root&quot;;
$password = &quot;&quot;;
$database = &quot;test_db&quot;;

// 创建连接
$conn = new mysqli($host, $username, $password, $database);

// 检查连接
if ($conn-&gt;connect_error) {
    die(&quot;连接失败: &quot; . $conn-&gt;connect_error);
}

// 设置字符集
$conn-&gt;set_charset(&quot;utf8&quot;);

// 查询数据
$sql = &quot;SELECT id, name, email FROM users&quot;;
$result = $conn-&gt;query($sql);

if ($result-&gt;num_rows &gt; 0) {
    while ($row = $result-&gt;fetch_assoc()) {
        echo &quot;ID: &quot; . $row[&quot;id&quot;] . &quot; - 姓名: &quot; . $row[&quot;name&quot;] . &quot; - 邮箱: &quot; . $row[&quot;email&quot;] . &quot;&lt;br&gt;&quot;;
    }
} else {
    echo &quot;没有数据&quot;;
}

// 插入数据
$name = &quot;新用户&quot;;
$email = &quot;newuser@example.com&quot;;
$sql = &quot;INSERT INTO users (name, email) VALUES (?, ?)&quot;;

$stmt = $conn-&gt;prepare($sql);
$stmt-&gt;bind_param(&quot;ss&quot;, $name, $email);

if ($stmt-&gt;execute()) {
    echo &quot;新记录插入成功&quot;;
} else {
    echo &quot;错误: &quot; . $stmt-&gt;error;
}

$stmt-&gt;close();
$conn-&gt;close();
?&gt;</code></pre>
                            <h2>会话管理</h2>
                            <h3>Session 使用</h3>
                            <pre><code class="language-php">&lt;?php
session_start();

// 设置 Session
$_SESSION[&quot;user_id&quot;] = 123;
$_SESSION[&quot;username&quot;] = &quot;张三&quot;;
$_SESSION[&quot;login_time&quot;] = time();

// 获取 Session
if (isset($_SESSION[&quot;username&quot;])) {
    echo &quot;欢迎, &quot; . $_SESSION[&quot;username&quot;];
}

// 销毁 Session
session_unset();
session_destroy();
?&gt;</code></pre>
                            <h3>Cookie 使用</h3>
                            <pre><code class="language-php">&lt;?php
// 设置 Cookie
setcookie(&quot;username&quot;, &quot;张三&quot;, time() + 3600, &quot;/&quot;); // 1小时过期

// 获取 Cookie
if (isset($_COOKIE[&quot;username&quot;])) {
    echo &quot;欢迎回来, &quot; . $_COOKIE[&quot;username&quot;];
}

// 删除 Cookie
setcookie(&quot;username&quot;, &quot;&quot;, time() - 3600, &quot;/&quot;);
?&gt;</code></pre>
                            <h2>错误处理</h2>
                            <h3>基本错误处理</h3>
                            <pre><code class="language-php">&lt;?php
// 自定义错误处理函数
function customError($errno, $errstr) {
    echo &quot;&lt;b&gt;错误:&lt;/b&gt; [$errno] $errstr&lt;br&gt;&quot;;
    echo &quot;脚本结束&quot;;
    die();
}

// 设置错误处理函数
set_error_handler(&quot;customError&quot;);

// 触发错误
echo($test);     // 未定义变量

// 异常处理
try {
    $result = 10 / 0;
} catch (Exception $e) {
    echo &quot;捕获异常: &quot; . $e-&gt;getMessage();
}

// 自定义异常
class CustomException extends Exception {
    public function errorMessage() {
        return &quot;错误行 &quot; . $this-&gt;getLine() . &quot; 在 &quot; . $this-&gt;getFile()
        . &quot;: &lt;b&gt;&quot; . $this-&gt;getMessage() . &quot;&lt;/b&gt; 不是一个有效的 E-Mail 地址&quot;;
    }
}

try {
    $email = &quot;someone@example...com&quot;;
    if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {
        throw new CustomException($email);
    }
} catch (CustomException $e) {
    echo $e-&gt;errorMessage();
}
?&gt;</code></pre>
                            <h2>Web安全</h2>
                            <h3>输入验证和过滤</h3>
                            <pre><code class="language-php">&lt;?php
// 获取并过滤输入
$name = filter_input(INPUT_POST, 'name', FILTER_SANITIZE_STRING);
$email = filter_input(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
$age = filter_input(INPUT_POST, 'age', FILTER_VALIDATE_INT);

// XSS 防护
function escape($string) {
    return htmlspecialchars($string, ENT_QUOTES, 'UTF-8');
}

// SQL 注入防护 (使用预处理语句)
$stmt = $conn-&gt;prepare(&quot;SELECT * FROM users WHERE email = ?&quot;);
$stmt-&gt;bind_param(&quot;s&quot;, $email);
$stmt-&gt;execute();
$result = $stmt-&gt;get_result();

// CSRF 防护
session_start();
if ($_SERVER['REQUEST_METHOD'] === 'POST') {
    if (!isset($_POST['csrf_token']) || $_POST['csrf_token'] !== $_SESSION['csrf_token']) {
        die('CSRF 验证失败');
    }
    // 处理表单提交
}

// 生成 CSRF Token
function generateCSRFToken() {
    if (empty($_SESSION['csrf_token'])) {
        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
    }
    return $_SESSION['csrf_token'];
}
?&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>

</html>