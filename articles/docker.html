<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Docker å­¦ä¹ ç¬”è®° - æˆ‘çš„ä¸ªäººåšå®¢</title>
    <link rel="stylesheet" href="../css/style.css">
    <link rel="stylesheet" href="../css/markdown.css">
</head>

<body>
    <div class="container">
        <header>
            <h1>æˆ‘çš„ä¸ªäººåšå®¢</h1>
            <nav>
                <span><a href="../index.html" class="no-underline">é¦–é¡µ</a></span>
            </nav>
        </header>

        <main>
            <div class="messages-list">
                <div class="messages-header">
                    <h3>ğŸ³ Docker å­¦ä¹ ç¬”è®°</h3>
                    <a href="../index.html" class="btn">è¿”å›é¦–é¡µ</a>
                </div>

                <div class="message-item">
                    <div class="message-header">
                        <span class="username">æŠ€æœ¯åˆ†äº«</span>
                        <span class="time">2025-12-20</span>
                    </div>
                    <div class="message-content">
                        <div class="markdown-content">
                            <h2>ğŸ¯ å­¦ä¹ ç›®æ ‡</h2>
                            <p>é€šè¿‡æœ¬ç¬”è®°æŒæ¡Dockerçš„æ ¸å¿ƒæ¦‚å¿µã€å¸¸ç”¨å‘½ä»¤å’Œå®é™…åº”ç”¨åœºæ™¯ï¼Œæå‡å®¹å™¨åŒ–éƒ¨ç½²èƒ½åŠ›ã€‚</p>
                            <hr>
                            <h2>ğŸ“– ç®€ä»‹</h2>
                            <p>Dockeræ˜¯ä¸€ä¸ªå¼€æºçš„å®¹å™¨åŒ–å¹³å°ï¼Œè®©å¼€å‘è€…èƒ½å¤Ÿæ‰“åŒ…åº”ç”¨åŠå…¶ä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„å®¹å™¨ä¸­ã€‚</p>
                            <h3>ğŸ”— ç›¸å…³é“¾æ¥</h3>
                            <ul>
                                <li><a href="https://github.com/docker/docker">Docker GitHubä»“åº“</a></li>
                                <li><a href="https://hub.docker.com">Docker Hubé•œåƒä»“åº“</a></li>
                            </ul>
                            <hr>
                            <h2>ğŸš€ å®‰è£…é…ç½®</h2>
                            <h3>åŸºç¡€å®‰è£…</h3>
                            <pre><code class="language-bash">apt install docker.io</code></pre>
                            <h3>é…ç½®é•œåƒåŠ é€Ÿå™¨</h3>
                            <pre><code class="language-json">tee /etc/docker/daemon.json &lt;&lt;-'EOF'
{
    &quot;registry-mirrors&quot;: [
     &quot;https://docker.m.daocloud.io&quot;,
     &quot;https://docker.imgdb.de&quot;,
     &quot;https://docker-0.unsee.tech&quot;,
     &quot;https://docker.hlmirror.com&quot;,
     &quot;https://docker.1ms.run&quot;,
     &quot;https://func.ink&quot;,
     &quot;https://lispy.org&quot;,
     &quot;https://docker.xiaogenban1993.com&quot;
    ]
}
EOF</code></pre>
                            <h3>é‡å¯DockeræœåŠ¡</h3>
                            <pre><code class="language-bash">systemctl daemon-reload
systemctl restart docker</code></pre>
                            <hr>
                            <h2>âš¡ å¸¸ç”¨å‘½ä»¤</h2>
                            <h3>ğŸ“¦ é•œåƒç›¸å…³å‘½ä»¤</h3>
                            <h4>ğŸ” æŸ¥çœ‹é•œåƒ</h4>
                            <pre><code class="language-bash">docker images</code></pre>
                            <p><strong>è¾“å‡ºè¯´æ˜ï¼š</strong></p>
                            <ul>
                                <li><code>REPOSITORY</code>ï¼šé•œåƒåç§°</li>
                                <li><code>TAG</code>ï¼šé•œåƒæ ‡ç­¾</li>
                                <li><code>IMAGE ID</code>ï¼šé•œåƒID</li>
                                <li><code>CREATED</code>ï¼šé•œåƒçš„åˆ›å»ºæ—¥æœŸ</li>
                                <li><code>SIZE</code>ï¼šé•œåƒå¤§å°</li>
                            </ul>
                            <h4>ğŸ” æœç´¢é•œåƒ</h4>
                            <pre><code class="language-bash">docker search é•œåƒåç§°</code></pre>
                            <p><strong>è¾“å‡ºè¯´æ˜ï¼š</strong></p>
                            <ul>
                                <li><code>NAME</code>ï¼šä»“åº“åç§°</li>
                                <li><code>DESCRIPTION</code>ï¼šé•œåƒæè¿°</li>
                                <li><code>STARS</code>ï¼šä¸‹è½½æ•°é‡</li>
                                <li><code>OFFICAL</code>ï¼šæ˜¯å¦å®˜æ–¹</li>
                                <li><code>AUTOMATED</code>ï¼šè‡ªåŠ¨æ„å»º</li>
                            </ul>
                            <h4>â¬‡ï¸ æ‹‰å–é•œåƒ</h4>
                            <pre><code class="language-bash">docker pull é•œåƒåç§°</code></pre>
                            <h4>ğŸ—‘ï¸ åˆ é™¤é•œåƒ</h4>
                            <pre><code class="language-bash"># åˆ é™¤å•ä¸ªé•œåƒ
docker rmi é•œåƒID

# åˆ é™¤æ‰€æœ‰é•œåƒ
docker rmi `docker images -q`</code></pre>
                            <h3>ğŸ—ï¸ å®¹å™¨ç›¸å…³å‘½ä»¤</h3>
                            <h4>ğŸ‘€ æŸ¥çœ‹å®¹å™¨</h4>
                            <pre><code class="language-bash"># æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„å®¹å™¨
docker ps

# æŸ¥çœ‹å…¨éƒ¨å®¹å™¨
docker ps -a

# æŸ¥çœ‹æœ€åä¸€æ¬¡è¿è¡Œçš„å®¹å™¨
docker ps -f status=exited</code></pre>
                            <h4>â–¶ï¸ å¯åŠ¨å®¹å™¨</h4>
                            <pre><code class="language-bash">docker run [å‚æ•°] é•œåƒå:æ ‡ç­¾ [å‘½ä»¤]</code></pre>
                            <p><strong>å¸¸ç”¨å‚æ•°ï¼š</strong></p>
                            <ul>
                                <li><code>-i</code>ï¼šè¡¨ç¤ºè¿è¡Œå®¹å™¨</li>
                                <li><code>-t</code>ï¼šè¡¨ç¤ºè¿›å…¥å‘½ä»¤è¡Œ</li>
                                <li><code>--name</code>ï¼šä¸ºåˆ›å»ºçš„å®¹å™¨å‘½å</li>
                                <li><code>-d</code>ï¼šå®ˆæŠ¤å¼å®¹å™¨ï¼ˆåå°è¿è¡Œï¼‰</li>
                                <li><code>-p</code>ï¼šæ˜ å°„ç«¯å£</li>
                            </ul>
                            <p><strong>ç¤ºä¾‹ï¼š</strong></p>
                            <pre><code class="language-bash"># äº¤äº’å¼å¯åŠ¨å®¹å™¨
docker run -it --name=centos centos:7 /bin/bash

# å®ˆæŠ¤å¼å¯åŠ¨å®¹å™¨
docker run -di --name=centos centos:7

# è¿›å…¥å®ˆæŠ¤å¼å®¹å™¨
docker exec -it å®¹å™¨åç§° /bin/bash</code></pre>
                            <h4>ğŸ”„ å®¹å™¨ç®¡ç†</h4>
                            <pre><code class="language-bash"># åœæ­¢å®¹å™¨
docker stop å®¹å™¨å/å®¹å™¨ID

# å¯åŠ¨å®¹å™¨
docker start å®¹å™¨å/å®¹å™¨ID

# é€€å‡ºå®¹å™¨
exit</code></pre>
                            <h4>ğŸ“ æ–‡ä»¶ä¼ è¾“</h4>
                            <pre><code class="language-bash"># ä»ä¸»æœºå¤åˆ¶æ–‡ä»¶åˆ°å®¹å™¨
docker cp æ–‡ä»¶è·¯å¾„ å®¹å™¨ID/åç§°:å®¹å™¨å†…è·¯å¾„

# ä»å®¹å™¨å¤åˆ¶æ–‡ä»¶åˆ°ä¸»æœº
docker cp å®¹å™¨ID/åç§°:å®¹å™¨å†…è·¯å¾„ ä¸»æœºè·¯å¾„</code></pre>
                            <h4>ğŸ“‚ ç›®å½•æŒ‚è½½</h4>
                            <pre><code class="language-bash">docker run -di -v ä¸»æœºç›®å½•:å®¹å™¨ç›®å½• --name=å®¹å™¨åç§° é•œåƒå</code></pre>
                            <p><strong>ç¤ºä¾‹ï¼š</strong></p>
                            <pre><code class="language-bash">docker run -di -v /usr/local/test:/usr/local/test --name=test centos:7</code></pre>
                            <h4>ğŸ—‘ï¸ åˆ é™¤å®¹å™¨</h4>
                            <pre><code class="language-bash">docker rm å®¹å™¨ID/å®¹å™¨åç§°</code></pre>
                            <hr>
                            <h2>ğŸŒ åº”ç”¨éƒ¨ç½²å®æˆ˜</h2>
                            <h3>ğŸ—„ï¸ MySQLéƒ¨ç½²</h3>
                            <pre><code class="language-bash"># æ‹‰å–MySQLé•œåƒ
docker pull mysql:5.7

# å¯åŠ¨MySQLå®¹å™¨
docker run -di --name=mysql \
  -p 3306:3306 \
  -e MYSQL_ROOT_PASSWORD=toor \
  mysql:5.7</code></pre>
                            <h3>ğŸŒ Nginxéƒ¨ç½²</h3>
                            <pre><code class="language-bash"># æ‹‰å–Nginxé•œåƒ
docker pull nginx

# å¯åŠ¨Nginxå®¹å™¨
docker run -di --name=nginx -p 80:80 nginx

# å¸¦é…ç½®æ–‡ä»¶æŒ‚è½½çš„Nginx
docker run -di --name=nginx \
  -p 80:80 \
  -v /usr/local/nginx:/etc/nginx \
  nginx</code></pre>
                            <h3>ğŸ”´ Rediséƒ¨ç½²</h3>
                            <pre><code class="language-bash"># æ‹‰å–Redisé•œåƒ
docker pull redis

# å¯åŠ¨Rediså®¹å™¨
docker run -di --name=redis -p 6379:6379 redis</code></pre>
                            <h3>ğŸ° RabbitMQéƒ¨ç½²</h3>
                            <pre><code class="language-bash"># æ‹‰å–RabbitMQé•œåƒ
docker pull rabbitmq:3.7.12

# å¯åŠ¨RabbitMQå®¹å™¨
docker run -di --name=rabbitmq \
  -p 5671:5671 \
  -p 5672:5672 \
  -p 4369:4369 \
  -p 25672:25672 \
  -p 15671:15671 \
  -p 15672:15672 \
  rabbitmq:3.7.12

# è¿›å…¥å®¹å™¨å¯ç”¨ç®¡ç†æ’ä»¶
docker exec -it rabbitmq /bin/bash
rabbitmq-plugins enable rabbitmq_management</code></pre>
                            <hr>
                            <h2>ğŸ’¾ å¤‡ä»½ä¸è¿ç§»</h2>
                            <h3>ğŸ“¦ å®¹å™¨ä¿å­˜ä¸ºé•œåƒ</h3>
                            <pre><code class="language-bash"># å°†å®¹å™¨ä¿å­˜ä¸ºæ–°é•œåƒ
docker commit å®¹å™¨å æ–°é•œåƒå

# å¯¼å‡ºé•œåƒåˆ°æ–‡ä»¶
docker save -o é•œåƒå.tar é•œåƒå

# ä»æ–‡ä»¶å¯¼å…¥é•œåƒ
docker load -i é•œåƒå.tar</code></pre>
                            <hr>
                            <h2>ğŸ“ Dockerfile</h2>
                            <p>Dockerfileæ˜¯ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ï¼ŒåŒ…å«äº†ä¸€ç³»åˆ—æŒ‡ä»¤ï¼Œç”¨äºè‡ªåŠ¨æ„å»ºDockeré•œåƒã€‚</p>
                            <h3>ğŸ—ï¸ åŸºæœ¬è¯­æ³•</h3>
                            <pre><code class="language-dockerfile"># åŸºç¡€é•œåƒ
FROM é•œåƒå:æ ‡ç­¾

# ç»´æŠ¤è€…ä¿¡æ¯
MAINTAINER ä½œè€… &lt;é‚®ç®±&gt;

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶æ–‡ä»¶
COPY æºè·¯å¾„ ç›®æ ‡è·¯å¾„

# æ·»åŠ æ–‡ä»¶ï¼ˆæ”¯æŒè§£å‹ï¼‰
ADD æºæ–‡ä»¶ ç›®æ ‡è·¯å¾„

# è¿è¡Œå‘½ä»¤
RUN å‘½ä»¤

# è®¾ç½®ç¯å¢ƒå˜é‡
ENV é”®=å€¼

# æš´éœ²ç«¯å£
EXPOSE ç«¯å£å·

# å®¹å™¨å¯åŠ¨å‘½ä»¤
CMD [&quot;å‘½ä»¤&quot;, &quot;å‚æ•°1&quot;, &quot;å‚æ•°2&quot;]

# å…¥å£ç‚¹
ENTRYPOINT [&quot;å‘½ä»¤&quot;, &quot;å‚æ•°1&quot;]</code></pre>
                            <h3>ğŸ“‹ å¸¸ç”¨æŒ‡ä»¤è¯¦è§£</h3>
                            <h4>FROM - åŸºç¡€é•œåƒ</h4>
                            <pre><code class="language-dockerfile">FROM ubuntu:20.04
FROM node:16-alpine</code></pre>
                            <h4>WORKDIR - å·¥ä½œç›®å½•</h4>
                            <pre><code class="language-dockerfile">WORKDIR /app
# ç›¸å½“äº cd /app</code></pre>
                            <h4>COPY vs ADD</h4>
                            <pre><code class="language-dockerfile"># COPY - ç®€å•å¤åˆ¶æ–‡ä»¶
COPY ./app.js /app/
COPY ./package*.json ./

# ADD - æ”¯æŒURLå’Œè§£å‹
ADD https://example.com/file.tar.gz /tmp/
ADD app.tar.gz /app/  # è‡ªåŠ¨è§£å‹</code></pre>
                            <h4>RUN - æ‰§è¡Œå‘½ä»¤</h4>
                            <pre><code class="language-dockerfile">RUN apt-get update &amp;&amp; apt-get install -y \
    curl \
    vim \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

RUN npm install</code></pre>
                            <h4>ENV - ç¯å¢ƒå˜é‡</h4>
                            <pre><code class="language-dockerfile">ENV NODE_ENV=production
ENV APP_VERSION=1.0.0</code></pre>
                            <h4>EXPOSE - æš´éœ²ç«¯å£</h4>
                            <pre><code class="language-dockerfile">EXPOSE 3000
EXPOSE 8080</code></pre>
                            <h4>CMD vs ENTRYPOINT</h4>
                            <pre><code class="language-dockerfile"># CMD - å¯ä»¥è¢«docker runè¦†ç›–
CMD [&quot;node&quot;, &quot;app.js&quot;]

# ENTRYPOINT - å›ºå®šå…¥å£ç‚¹
ENTRYPOINT [&quot;node&quot;]
CMD [&quot;app.js&quot;]  # ä½œä¸ºENTRYPOINTçš„å‚æ•°</code></pre>
                            <h3>ğŸ¯ å®æˆ˜ç¤ºä¾‹</h3>
                            <h4>Node.jsåº”ç”¨Dockerfile</h4>
                            <pre><code class="language-dockerfile">FROM node:16-alpine

# è®¾ç½®å·¥ä½œç›®å½•
WORKDIR /app

# å¤åˆ¶packageæ–‡ä»¶
COPY package*.json ./

# å®‰è£…ä¾èµ–
RUN npm ci --only=production

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# åˆ›å»ºérootç”¨æˆ·
RUN addgroup -g 1001 -S nodejs
RUN adduser -S nodejs -u 1001

# æ›´æ”¹æ–‡ä»¶æ‰€æœ‰è€…
RUN chown -R nodejs:nodejs /app
USER nodejs

# æš´éœ²ç«¯å£
EXPOSE 3000

# å¥åº·æ£€æŸ¥
HEALTHCHECK --interval=30s --timeout=3s --start-period=5s --retries=3 \
  CMD curl -f http://localhost:3000/health || exit 1

# å¯åŠ¨åº”ç”¨
CMD [&quot;node&quot;, &quot;app.js&quot;]</code></pre>
                            <h4>Pythonåº”ç”¨Dockerfile</h4>
                            <pre><code class="language-dockerfile">FROM python:3.9-slim

WORKDIR /app

# å®‰è£…ç³»ç»Ÿä¾èµ–
RUN apt-get update &amp;&amp; apt-get install -y \
    gcc \
    &amp;&amp; rm -rf /var/lib/apt/lists/*

# å¤åˆ¶requirementsæ–‡ä»¶
COPY requirements.txt .

# å®‰è£…Pythonä¾èµ–
RUN pip install --no-cache-dir -r requirements.txt

# å¤åˆ¶åº”ç”¨ä»£ç 
COPY . .

# æš´éœ²ç«¯å£
EXPOSE 8000

# å¯åŠ¨åº”ç”¨
CMD [&quot;python&quot;, &quot;app.py&quot;]</code></pre>
                            <h4>å¤šé˜¶æ®µæ„å»º</h4>
                            <pre><code class="language-dockerfile"># æ„å»ºé˜¶æ®µ
FROM node:16-alpine AS builder

WORKDIR /app
COPY package*.json ./
RUN npm ci
COPY . .
RUN npm run build

# ç”Ÿäº§é˜¶æ®µ
FROM nginx:alpine

# å¤åˆ¶æ„å»ºç»“æœ
COPY --from=builder /app/dist /usr/share/nginx/html

# å¤åˆ¶nginxé…ç½®
COPY nginx.conf /etc/nginx/nginx.conf

EXPOSE 80

CMD [&quot;nginx&quot;, &quot;-g&quot;, &quot;daemon off;&quot;]</code></pre>
                            <h3>ğŸ”§ æ„å»ºé•œåƒ</h3>
                            <pre><code class="language-bash"># æ„å»ºé•œåƒ
docker build -t é•œåƒå:æ ‡ç­¾ .

# æ„å»ºæ—¶æŒ‡å®šDockerfile
docker build -f Dockerfile.prod -t myapp:prod .

# æ„å»ºæ—¶ä¼ é€’å‚æ•°
docker build --build-arg VERSION=1.0.0 -t myapp .</code></pre>
                            <hr>
                            <h2>ğŸ™ Docker Compose</h2>
                            <p>Docker Composeç”¨äºå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨ç¨‹åºçš„å·¥å…·ã€‚</p>
                            <h3>ğŸ“„ docker-compose.yamlåŸºæœ¬ç»“æ„</h3>
                            <pre><code class="language-yaml">version: '3.8'  # ç‰ˆæœ¬å·

services:       # æœåŠ¡å®šä¹‰
  æœåŠ¡å:
    build: ./ç›®å½•           # æ„å»ºé…ç½®
    image: é•œåƒå:æ ‡ç­¾       # ä½¿ç”¨é•œåƒ
    ports:                  # ç«¯å£æ˜ å°„
      - &quot;ä¸»æœºç«¯å£:å®¹å™¨ç«¯å£&quot;
    volumes:                # å·æŒ‚è½½
      - ä¸»æœºè·¯å¾„:å®¹å™¨è·¯å¾„
    environment:            # ç¯å¢ƒå˜é‡
      - é”®=å€¼
    depends_on:            # ä¾èµ–å…³ç³»
      - å…¶ä»–æœåŠ¡å
    networks:              # ç½‘ç»œé…ç½®
      - ç½‘ç»œå

volumes:        # æ•°æ®å·å®šä¹‰
  å·å:

networks:       # ç½‘ç»œå®šä¹‰
  ç½‘ç»œå:
    driver: bridge</code></pre>
                            <h3>ğŸ¯ å¸¸ç”¨é…ç½®é€‰é¡¹</h3>
                            <h4>æœåŠ¡é…ç½®è¯¦è§£</h4>
                            <pre><code class="language-yaml">services:
  web:
    # æ„å»ºé…ç½®
    build:
      context: ./web          # æ„å»ºä¸Šä¸‹æ–‡
      dockerfile: Dockerfile  # Dockerfileè·¯å¾„
      args:                   # æ„å»ºå‚æ•°
        VERSION: &quot;1.0&quot;
    
    # é•œåƒé…ç½®
    image: nginx:alpine
    container_name: my-web
    
    # ç«¯å£é…ç½®
    ports:
      - &quot;8080:80&quot;
      - &quot;443:443&quot;
    
    # ç¯å¢ƒå˜é‡
    environment:
      - NODE_ENV=production
      - DB_HOST=db
      - REDIS_URL=redis://redis:6379
    
    # ç¯å¢ƒå˜é‡æ–‡ä»¶
    env_file:
      - .env
      - .env.production
    
    # å·æŒ‚è½½
    volumes:
      - ./html:/usr/share/nginx/html
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - static_volume:/var/www/static
    
    # ä¾èµ–å…³ç³»
    depends_on:
      - db
      - redis
    
    # ç½‘ç»œé…ç½®
    networks:
      - frontend
      - backend
    
    # é‡å¯ç­–ç•¥
    restart: unless-stopped
    
    # å¥åº·æ£€æŸ¥
    healthcheck:
      test: [&quot;CMD&quot;, &quot;curl&quot;, &quot;-f&quot;, &quot;http://localhost:80/health&quot;]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s</code></pre>
                            <h3>ğŸŒ å®æˆ˜ç¤ºä¾‹</h3>
                            <h4>Webåº”ç”¨å®Œæ•´é…ç½®</h4>
                            <pre><code class="language-yaml">version: '3.8'

services:
  # WebæœåŠ¡
  web:
    build: .
    container_name: myapp-web
    ports:
      - &quot;3000:3000&quot;
    environment:
      - NODE_ENV=production
      - DB_HOST=db
      - DB_PORT=5432
      - DB_NAME=myapp
      - DB_USER=postgres
      - REDIS_URL=redis://redis:6379
    depends_on:
      - db
      - redis
    networks:
      - app-network
    restart: unless-stopped

  # æ•°æ®åº“æœåŠ¡
  db:
    image: postgres:13
    container_name: myapp-db
    environment:
      - POSTGRES_DB=myapp
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=secretpassword
    volumes:
      - postgres_data:/var/lib/postgresql/data
      - ./init.sql:/docker-entrypoint-initdb.d/init.sql
    ports:
      - &quot;5432:5432&quot;
    networks:
      - app-network
    restart: unless-stopped

  # RedisæœåŠ¡
  redis:
    image: redis:6-alpine
    container_name: myapp-redis
    ports:
      - &quot;6379:6379&quot;
    volumes:
      - redis_data:/data
    networks:
      - app-network
    restart: unless-stopped
    command: redis-server --appendonly yes

  # Nginxåå‘ä»£ç†
  nginx:
    image: nginx:alpine
    container_name: myapp-nginx
    ports:
      - &quot;80:80&quot;
      - &quot;443:443&quot;
    volumes:
      - ./nginx.conf:/etc/nginx/nginx.conf:ro
      - ./ssl:/etc/nginx/ssl:ro
    depends_on:
      - web
    networks:
      - app-network
    restart: unless-stopped

# æ•°æ®å·å®šä¹‰
volumes:
  postgres_data:
  redis_data:

# ç½‘ç»œå®šä¹‰
networks:
  app-network:
    driver: bridge</code></pre>
                            <h4>å¼€å‘ç¯å¢ƒé…ç½®</h4>
                            <pre><code class="language-yaml">version: '3.8'

services:
  app:
    build:
      context: .
      dockerfile: Dockerfile.dev
    volumes:
      - .:/app
      - /app/node_modules  # é˜²æ­¢node_modulesè¢«è¦†ç›–
    ports:
      - &quot;3000:3000&quot;
      - &quot;9229:9229&quot;  # Node.jsè°ƒè¯•ç«¯å£
    environment:
      - NODE_ENV=development
      - CHOKIDAR_USEPOLLING=true  # æ”¯æŒçƒ­é‡è½½
    command: npm run dev
    depends_on:
      - db
      - redis
    networks:
      - dev-network

  db:
    image: mysql:8.0
    environment:
      - MYSQL_ROOT_PASSWORD=root
      - MYSQL_DATABASE=devdb
    ports:
      - &quot;3306:3306&quot;
    volumes:
      - mysql_dev_data:/var/lib/mysql
    networks:
      - dev-network

  redis:
    image: redis:6-alpine
    ports:
      - &quot;6379:6379&quot;
    networks:
      - dev-network

volumes:
  mysql_dev_data:

networks:
  dev-network:
    driver: bridge</code></pre>
                            <h3>âš¡ å¸¸ç”¨å‘½ä»¤</h3>
                            <pre><code class="language-bash"># å¯åŠ¨æ‰€æœ‰æœåŠ¡ï¼ˆåå°è¿è¡Œï¼‰
docker-compose up -d

# å¯åŠ¨æŒ‡å®šæœåŠ¡
docker-compose up -d web

# å¯åŠ¨å¹¶æŸ¥çœ‹æ—¥å¿—
docker-compose up

# åœæ­¢æ‰€æœ‰æœåŠ¡
docker-compose down

# åœæ­¢å¹¶åˆ é™¤æ•°æ®å·
docker-compose down -v

# åœæ­¢å¹¶åˆ é™¤é•œåƒ
docker-compose down --rmi all

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs
docker-compose logs -f web  # å®æ—¶æŸ¥çœ‹webæœåŠ¡æ—¥å¿—
docker-compose logs --tail=100  # æŸ¥çœ‹æœ€å100è¡Œ

# è¿›å…¥å®¹å™¨
docker-compose exec web bash
docker-compose exec db mysql -u root -p

# æ‰§è¡Œå‘½ä»¤
docker-compose run web npm run test

# æ‰©å±•æœåŠ¡
docker-compose up -d --scale web=3

# æŸ¥çœ‹èµ„æºä½¿ç”¨
docker-compose top</code></pre>
                            <h3>ğŸ”§ é«˜çº§é…ç½®</h3>
                            <h4>ç¯å¢ƒå˜é‡æ–‡ä»¶</h4>
                            <pre><code class="language-bash"># .envæ–‡ä»¶
NODE_ENV=production
DB_HOST=db
DB_PORT=5432
DB_NAME=myapp
DB_USER=postgres
DB_PASSWORD=secretpassword</code></pre>
                            <h4>è¦†ç›–é…ç½®</h4>
                            <pre><code class="language-yaml"># docker-compose.override.yml
version: '3.8'

services:
  web:
    volumes:
      - ./src:/app/src  # å¼€å‘æ—¶æŒ‚è½½æºç 
    environment:
      - NODE_ENV=development
    command: npm run dev</code></pre>
                            <h4>ç”Ÿäº§ç¯å¢ƒé…ç½®</h4>
                            <pre><code class="language-yaml"># docker-compose.prod.yml
version: '3.8'

services:
  web:
    deploy:
      replicas: 3
      resources:
        limits:
          cpus: '0.5'
          memory: 512M
        reservations:
          cpus: '0.25'
          memory: 256M
    logging:
      driver: &quot;json-file&quot;
      options:
        max-size: &quot;10m&quot;
        max-file: &quot;3&quot;</code></pre>
                            <hr>
                            <h2>ğŸ”’ Dockerç§æœ‰ä»“åº“</h2>
                            <p>Dockerç§æœ‰ä»“åº“ç”¨äºå­˜å‚¨å’Œç®¡ç†è‡ªå®šä¹‰çš„Dockeré•œåƒã€‚</p>
                            <h3>ğŸ—ï¸ æ­å»ºç§æœ‰ä»“åº“</h3>
                            <h4>ä½¿ç”¨å®˜æ–¹Registryé•œåƒ</h4>
                            <pre><code class="language-bash"># æ‹‰å–Registryé•œåƒ
docker pull registry

# å¯åŠ¨ç§æœ‰ä»“åº“
docker run -di --name=registry \
  -p 5000:5000 \
  -v /opt/registry:/var/lib/registry \
  registry

# å¯åŠ¨å¸¦è®¤è¯çš„ç§æœ‰ä»“åº“
docker run -di --name=registry-auth \
  -p 5000:5000 \
  -v /opt/registry:/var/lib/registry \
  -v /opt/auth:/auth \
  -e REGISTRY_AUTH=htpasswd \
  -e REGISTRY_AUTH_HTPASSWD_REALM=&quot;Registry Realm&quot; \
  -e REGISTRY_AUTH_HTPASSWD_PATH=/auth/htpasswd \
  registry</code></pre>
                            <h4>é…ç½®è®¤è¯</h4>
                            <pre><code class="language-bash"># å®‰è£…htpasswdå·¥å…·
apt install apache2-utils

# åˆ›å»ºè®¤è¯æ–‡ä»¶
htpasswd -Bbn testuser testpass &gt; /opt/auth/htpasswd</code></pre>
                            <h3>ğŸ”§ é…ç½®Dockerå®¢æˆ·ç«¯</h3>
                            <pre><code class="language-bash"># ä¿®æ”¹Dockeré…ç½®æ–‡ä»¶
vi /etc/docker/daemon.json

{
  &quot;insecure-registries&quot;: [&quot;ç§æœ‰ä»“åº“IP:5000&quot;]
}

# é‡å¯Docker
systemctl restart docker</code></pre>
                            <h3>ğŸ“¦ æ¨é€å’Œæ‹‰å–é•œåƒ</h3>
                            <pre><code class="language-bash"># æ ‡è®°é•œåƒ
docker tag æœ¬åœ°é•œåƒå:æ ‡ç­¾ ç§æœ‰ä»“åº“IP:5000/é•œåƒå:æ ‡ç­¾

# æ¨é€é•œåƒ
docker push ç§æœ‰ä»“åº“IP:5000/é•œåƒå:æ ‡ç­¾

# æ‹‰å–é•œåƒ
docker pull ç§æœ‰ä»“åº“IP:5000/é•œåƒå:æ ‡ç­¾

# æŸ¥çœ‹ä»“åº“ä¸­çš„é•œåƒ
curl http://ç§æœ‰ä»“åº“IP:5000/v2/_catalog</code></pre>
                            <hr>
                            <h2>ğŸ”§ Docker Mavenæ’ä»¶</h2>
                            <p>Docker Mavenæ’ä»¶ç”¨äºåœ¨Mavenæ„å»ºè¿‡ç¨‹ä¸­è‡ªåŠ¨æ„å»ºå’Œæ¨é€Dockeré•œåƒã€‚</p>
                            <h3>ğŸ“ æ’ä»¶é…ç½®</h3>
                            <h4>pom.xmlé…ç½®</h4>
                            <pre><code class="language-xml">&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;com.spotify&lt;/groupId&gt;
            &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;1.4.13&lt;/version&gt;
            &lt;configuration&gt;
                &lt;repository&gt;your-registry/${project.artifactId}&lt;/repository&gt;
                &lt;tag&gt;${project.version}&lt;/tag&gt;
                &lt;buildArgs&gt;
                    &lt;JAR_FILE&gt;target/${project.build.finalName}.jar&lt;/JAR_FILE&gt;
                &lt;/buildArgs&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
                            <h4>Dockerfileç¤ºä¾‹</h4>
                            <pre><code class="language-dockerfile">FROM openjdk:11-jre-slim

ARG JAR_FILE
COPY ${JAR_FILE} app.jar

EXPOSE 8080

ENTRYPOINT [&quot;java&quot;, &quot;-jar&quot;, &quot;/app.jar&quot;]</code></pre>
                            <h3>âš¡ Mavenå‘½ä»¤</h3>
                            <pre><code class="language-bash"># æ„å»ºDockeré•œåƒ
mvn dockerfile:build

# æ¨é€é•œåƒåˆ°ä»“åº“
mvn dockerfile:push

# æ„å»ºå¹¶æ¨é€
mvn dockerfile:build dockerfile:push

# æŒ‡å®šæ ‡ç­¾
mvn dockerfile:build -Ddockerfile.tag=latest

# å¼ºåˆ¶é‡å»º
mvn dockerfile:build -Ddockerfile.noCache</code></pre>
                            <h3>ğŸ¯ é«˜çº§é…ç½®</h3>
                            <h4>å¤šç¯å¢ƒé…ç½®</h4>
                            <pre><code class="language-xml">&lt;profiles&gt;
    &lt;profile&gt;
        &lt;id&gt;dev&lt;/id&gt;
        &lt;properties&gt;
            &lt;docker.registry&gt;localhost:5000&lt;/docker.registry&gt;
        &lt;/properties&gt;
    &lt;/profile&gt;
    &lt;profile&gt;
        &lt;id&gt;prod&lt;/id&gt;
        &lt;properties&gt;
            &lt;docker.registry&gt;registry.example.com&lt;/docker.registry&gt;
        &lt;/properties&gt;
    &lt;/profile&gt;
&lt;/profiles&gt;

&lt;build&gt;
    &lt;plugins&gt;
        &lt;plugin&gt;
            &lt;groupId&gt;com.spotify&lt;/groupId&gt;
            &lt;artifactId&gt;dockerfile-maven-plugin&lt;/artifactId&gt;
            &lt;configuration&gt;
                &lt;repository&gt;${docker.registry}/${project.artifactId}&lt;/repository&gt;
                &lt;tag&gt;${project.version}&lt;/tag&gt;
            &lt;/configuration&gt;
        &lt;/plugin&gt;
    &lt;/plugins&gt;
&lt;/build&gt;</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
</body>

</html>